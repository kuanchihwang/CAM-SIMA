<!-- -*- mode: jinja2 -*- -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="MPAS dynamical core solves the fully compressible non-hydrostatic equations of atmospheric motion.">
    <meta name="author" content="CAM-SIMA & MPAS Developers">
    <link href="../favicon.png" rel="icon">

    <title>dynamics_to_physics_coupling – MPAS Dynamical Core</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      crossorigin="anonymous"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      rel="stylesheet"
    >
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    ></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
      async
      crossorigin="anonymous"
      integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw="
    ></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>
    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html"
            >MPAS Dynamical Core </a
          >
          <button
            class="navbar-toggler"
            data-bs-target="#navbar"
            data-bs-toggle="collapse"
            type="button"
            aria-controls="navbar"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse collapse" id="navbar">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div>
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>
      dynamics_to_physics_coupling
      <small
        >          Module
          Subroutine
</small
      >
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 6.0% of total for procedures.">229 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dyn_coupling_impl.F90">Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dyn_coupling_impl.f90.html'>dyn_coupling_impl.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/dyn_coupling_impl.html'>dyn_coupling_impl</a></li>
            <li class="breadcrumb-item active" aria-current="page">dynamics_to_physics_coupling</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">  <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-column_index">column_index</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-dp_col">dp_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-dpd_col">dpd_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-dz_col">dz_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-exner">exner</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-index_qv~4">index_qv</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-is_water_species_index~2">is_water_species_index</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-omega_mid_col">omega_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-p_int_col">p_int_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-p_mid_col~2">p_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-pd_int_col">pd_int_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-pd_mid_col">pd_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-qv_mid_col~2">qv_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-rho_mid_col">rho_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-rho_zz">rho_zz</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-rhod_mid_col">rhod_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-scalars~4">scalars</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-sigma_all_q_mid_col">sigma_all_q_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-subname~68">subname</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-t_mid_col">t_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-theta_m">theta_m</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-tm_mid_col~2">tm_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-tv_mid_col~2">tv_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-u_mid_col">u_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-ucellmeridional~3">ucellmeridional</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-ucellzonal~3">ucellzonal</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-v_mid_col">v_mid_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-w~4">w</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-z_int_col">z_int_col</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-zgrid~3">zgrid</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#variable-zz~2">zz</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-final_shared_variables~2">final_shared_variables</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-init_shared_variables~2">init_shared_variables</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_column">set_physics_state_column</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_external">set_physics_state_external</a>
            <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#proc-update_shared_variables">update_shared_variables</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dynamics_to_physics_coupling.html#src">dynamics_to_physics_coupling</a>
      </div>
    </div>


  </div>
</div>

    <div class="col-md-9" id="text">
      <h2>module subroutine dynamics_to_physics_coupling()  
    <a href="../interface/dynamics_to_physics_coupling.html"><button type="button" class="btn btn-info depwarn">Interface →</button></a>
</h2>
          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='../module/dyn_grid.html'>dyn_grid</a></li>
                  <li class="list-inline-item">cam_logfile</li>
                  <li class="list-inline-item"><a href='../module/dyn_comp.html'>dyn_comp</a></li>
                  <li class="list-inline-item">shr_kind_mod</li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.0 (20251207.0913)
 -->
<!-- Title: proc~~dynamics_to_physics_coupling~~UsesGraph Pages: 1 -->
<svg id="procdynamics_to_physics_couplingUsesGraph" width="641pt" height="150pt"
 viewBox="0.00 0.00 641.00 150.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph" class="graph" transform="scale(0.844978 0.844978) rotate(0) translate(4 173.27)">
<title>proc~~dynamics_to_physics_coupling~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-173.27 754.6,-173.27 754.6,4 -4,4"/>
<!-- proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node1" class="node">
<title>proc~dynamics_to_physics_coupling</title>
<polygon fill="none" stroke="black" points="750.6,-86.27 577.08,-86.27 577.08,-62 750.6,-62 750.6,-86.27"/>
<text xml:space="preserve" text-anchor="middle" x="663.84" y="-70.53" font-family="Helvetica,sans-Serif" font-size="10.50">dynamics_to_physics_coupling</text>
</g>
<!-- cam_logfile -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node2" class="node">
<title>cam_logfile</title>
<polygon fill="#337ab7" stroke="#337ab7" points="535.08,-146.27 462.06,-146.27 462.06,-122 535.08,-122 535.08,-146.27"/>
<text xml:space="preserve" text-anchor="middle" x="498.57" y="-130.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_logfile</text>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;cam_logfile -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge1" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;cam_logfile</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M628.61,-86.71C604.12,-95.71 570.92,-107.91 544.33,-117.69"/>
<polygon fill="#000000" stroke="#000000" points="543.35,-114.32 535.17,-121.05 545.77,-120.89 543.35,-114.32"/>
</g>
<!-- module~dyn_comp -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node3" class="node">
<title>module~dyn_comp</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node3"><a xlink:href="../module/dyn_comp.html" xlink:title="dyn_comp">
<polygon fill="#337ab7" stroke="#337ab7" points="399.81,-106.27 333.54,-106.27 333.54,-82 399.81,-82 399.81,-106.27"/>
<text xml:space="preserve" text-anchor="middle" x="366.67" y="-90.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_comp</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_comp -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge2" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_comp</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M576.67,-79.97C522.43,-83.65 454.72,-88.24 411.33,-91.18"/>
<polygon fill="#000000" stroke="#000000" points="411.29,-87.67 401.55,-91.84 411.76,-94.66 411.29,-87.67"/>
</g>
<!-- module~dyn_grid -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node4" class="node">
<title>module~dyn_grid</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node4"><a xlink:href="../module/dyn_grid.html" xlink:title="dyn_grid">
<polygon fill="#337ab7" stroke="#337ab7" points="527.2,-66.27 469.93,-66.27 469.93,-42 527.2,-42 527.2,-66.27"/>
<text xml:space="preserve" text-anchor="middle" x="498.57" y="-50.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_grid</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_grid -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge3" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;module~dyn_grid</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M576.9,-63.61C563.67,-61.99 550.6,-60.39 539.07,-58.97"/>
<polygon fill="#000000" stroke="#000000" points="539.52,-55.5 529.17,-57.76 538.67,-62.45 539.52,-55.5"/>
</g>
<!-- shr_kind_mod -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node5" class="node">
<title>shr_kind_mod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="541.08,-24.27 456.06,-24.27 456.06,0 541.08,0 541.08,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="498.57" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shr_kind_mod</text>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;shr_kind_mod -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge4" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;shr_kind_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M629.8,-61.59C604.88,-52.12 570.45,-39.05 543.25,-28.72"/>
<polygon fill="#000000" stroke="#000000" points="544.85,-25.58 534.26,-25.31 542.36,-32.13 544.85,-25.58"/>
</g>
<!-- module~dyn_mpas_subdriver -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node7" class="node">
<title>module~dyn_mpas_subdriver</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node7"><a xlink:href="../module/dyn_mpas_subdriver.html" xlink:title="dyn_mpas_subdriver">
<polygon fill="#337ab7" stroke="#337ab7" points="277.29,-106.27 156.27,-106.27 156.27,-82 277.29,-82 277.29,-106.27"/>
<text xml:space="preserve" text-anchor="middle" x="216.78" y="-90.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_mpas_subdriver</text>
</a>
</g>
</g>
<!-- module~dyn_comp&#45;&gt;module~dyn_mpas_subdriver -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge5" class="edge">
<title>module~dyn_comp&#45;&gt;module~dyn_mpas_subdriver</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M333.22,-94.13C320.08,-94.13 304.36,-94.13 288.81,-94.13"/>
<polygon fill="#000000" stroke="#000000" points="289.08,-90.64 279.08,-94.14 289.08,-97.64 289.08,-90.64"/>
</g>
<!-- module~dyn_grid&#45;&gt;module~dyn_comp -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge7" class="edge">
<title>module~dyn_grid&#45;&gt;module~dyn_comp</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M469.7,-62.72C452.63,-67.97 430.41,-74.82 411.07,-80.77"/>
<polygon fill="#000000" stroke="#000000" points="410.05,-77.42 401.52,-83.71 412.11,-84.11 410.05,-77.42"/>
</g>
<!-- cam_grid_support -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node6" class="node">
<title>cam_grid_support</title>
<polygon fill="#337ab7" stroke="#337ab7" points="420.06,-64.27 313.29,-64.27 313.29,-40 420.06,-40 420.06,-64.27"/>
<text xml:space="preserve" text-anchor="middle" x="366.67" y="-48.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_support</text>
</g>
<!-- module~dyn_grid&#45;&gt;cam_grid_support -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge6" class="edge">
<title>module~dyn_grid&#45;&gt;cam_grid_support</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M469.7,-53.71C458.46,-53.53 445,-53.33 431.59,-53.12"/>
<polygon fill="#000000" stroke="#000000" points="431.95,-49.62 421.9,-52.97 431.84,-56.62 431.95,-49.62"/>
</g>
<!-- iso_fortran_env -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node8" class="node">
<title>iso_fortran_env</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node8"><a xlink:href="https://www.intel.com/content/www/us/en/docs/fortran-compiler/developer-guide-reference/2024-2/iso-fortran-env-module.html" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="106.77,-169.27 13.5,-169.27 13.5,-145 106.77,-145 106.77,-169.27"/>
<text xml:space="preserve" text-anchor="middle" x="60.13" y="-153.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;iso_fortran_env -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge8" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M188.83,-106.62C169.82,-115.26 143.67,-126.85 120.27,-136.13 116.45,-137.65 112.47,-139.18 108.47,-140.67"/>
<polygon fill="#000000" stroke="#000000" points="107.49,-137.3 99.3,-144.03 109.9,-143.88 107.49,-137.3"/>
</g>
<!-- mpas_derived_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node9" class="node">
<title>mpas_derived_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="120.27,-127.27 0,-127.27 0,-103 120.27,-103 120.27,-127.27"/>
<text xml:space="preserve" text-anchor="middle" x="60.13" y="-111.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_derived_types</text>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;mpas_derived_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge9" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;mpas_derived_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M155.99,-102.25C148.13,-103.32 140.02,-104.42 132,-105.51"/>
<polygon fill="#000000" stroke="#000000" points="131.7,-102.02 122.27,-106.83 132.65,-108.96 131.7,-102.02"/>
</g>
<!-- mpas_kind_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node10" class="node">
<title>mpas_kind_types</title>
<polygon fill="#337ab7" stroke="#337ab7" points="111.27,-85.27 9,-85.27 9,-61 111.27,-61 111.27,-85.27"/>
<text xml:space="preserve" text-anchor="middle" x="60.13" y="-69.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_kind_types</text>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;mpas_kind_types -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge10" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;mpas_kind_types</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M155.99,-86.02C145.14,-84.54 133.8,-83 122.9,-81.52"/>
<polygon fill="#000000" stroke="#000000" points="123.61,-78.09 113.23,-80.21 122.67,-85.02 123.61,-78.09"/>
</g>
<!-- mpi -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_node11" class="node">
<title>mpi</title>
<g id="a_proc~~dynamics_to_physics_coupling~~UsesGraph_node11"><a xlink:href="https://www.mpi-forum.org/docs/mpi-4.1/mpi41-report/node467.htm" xlink:title="mpi">
<polygon fill="#337ab7" stroke="#337ab7" points="87.13,-43.27 33.13,-43.27 33.13,-19 87.13,-19 87.13,-43.27"/>
<text xml:space="preserve" text-anchor="middle" x="60.13" y="-27.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpi</text>
</a>
</g>
</g>
<!-- module~dyn_mpas_subdriver&#45;&gt;mpi -->
<g id="proc~~dynamics_to_physics_coupling~~UsesGraph_edge11" class="edge">
<title>module~dyn_mpas_subdriver&#45;&gt;mpi</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M188.83,-81.65C169.82,-73.01 143.67,-61.42 120.27,-52.13 113.21,-49.33 105.61,-46.5 98.28,-43.86"/>
<polygon fill="#000000" stroke="#000000" points="99.51,-40.58 88.91,-40.54 97.17,-47.18 99.51,-40.58"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocdynamics_to_physics_couplingUsesGraph = svgPanZoom('#procdynamics_to_physics_couplingUsesGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.0 (20251207.0913)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="511pt" height="32pt"
 viewBox="0.00 0.00 511.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28.27)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28.27 506.88,-28.27 506.88,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24.27 0,-24.27 0,0 54,0 54,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="27" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="144.13,-24.27 71.87,-24.27 71.87,0 144.13,0 144.13,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="108" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="231.63,-24.27 162.37,-24.27 162.37,0 231.63,0 231.63,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="197" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="306.26,-24.27 249.74,-24.27 249.74,0 306.26,0 306.26,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="278" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="381.26,-24.27 324.74,-24.27 324.74,0 381.26,0 381.26,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="353" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="502.88,-24.27 399.12,-24.27 399.12,0 502.88,0 502.88,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="451" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 </div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


        <p>Perform one-way coupling from the dynamics output states to the physics input states.
The other coupling direction is implemented by its counterpart, <code>physics_to_dynamics_coupling</code>.
(KCW, 2024-07-31)</p>


      <h3>Arguments</h3>
        <em>None</em>
        <br>
        <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Calls</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.0 (20251207.0913)
 -->
<!-- Title: proc~~dynamics_to_physics_coupling~~CallsGraph Pages: 1 -->
<svg id="procdynamics_to_physics_couplingCallsGraph" width="641pt" height="560pt"
 viewBox="0.00 0.00 641.00 560.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph" class="graph" transform="scale(0.300141 0.300141) rotate(0) translate(4 1862.61)">
<title>proc~~dynamics_to_physics_coupling~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-1862.61 2131.66,-1862.61 2131.66,4 -4,4"/>
<!-- proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node1" class="node">
<title>proc~dynamics_to_physics_coupling</title>
<polygon fill="none" stroke="black" points="173.52,-1361.27 0,-1361.27 0,-1337 173.52,-1337 173.52,-1361.27"/>
<text xml:space="preserve" text-anchor="middle" x="86.76" y="-1345.54" font-family="Helvetica,sans-Serif" font-size="10.50">dynamics_to_physics_coupling</text>
</g>
<!-- interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node2" class="node">
<title>interface~dyn_debug_print</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node2"><a xlink:href="../interface/dyn_debug_print.html" xlink:title="dyn_debug_print">
<polygon fill="#a7506f" stroke="#a7506f" points="1080.22,-1157.27 980.2,-1157.27 980.2,-1133 1080.22,-1133 1080.22,-1157.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-1141.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_debug_print</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge1" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M89.15,-1361.61C95.08,-1409.8 122.1,-1586.61 209.52,-1696.13 320.05,-1834.61 443.46,-1913.27 590.31,-1814.13 654.65,-1770.7 789.9,-1213.28 851.58,-1166.13 884.45,-1141.01 931.21,-1136.35 968.51,-1137.66"/>
<polygon fill="#000000" stroke="#000000" points="968.07,-1141.14 978.24,-1138.16 968.44,-1134.15 968.07,-1141.14"/>
</g>
<!-- interface~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node3" class="node">
<title>interface~dyn_exchange_constituent_states</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node3"><a xlink:href="../interface/dyn_exchange_constituent_states.html" xlink:title="dyn_exchange_constituent_states">
<polygon fill="#a7506f" stroke="#a7506f" points="588.43,-907.27 399.16,-907.27 399.16,-883 588.43,-883 588.43,-907.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-891.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_exchange_constituent_states</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge2" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;interface~dyn_exchange_constituent_states</title>
<path fill="none" stroke="#000000" d="M95.27,-1336.56C126.8,-1284.52 253.45,-1082.79 397.29,-954.13 415.31,-938.02 438.29,-923.67 457.19,-913.16"/>
<polygon fill="#000000" stroke="#000000" points="458.76,-916.29 465.88,-908.45 455.42,-910.13 458.76,-916.29"/>
</g>
<!-- none~final_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node4" class="node">
<title>none~final_shared_variables~2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node4"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-final_shared_variables~2" xlink:title="final_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="350.41,-1403.27 220.39,-1403.27 220.39,-1379 350.41,-1379 350.41,-1403.27"/>
<text xml:space="preserve" text-anchor="middle" x="285.4" y="-1387.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">final_shared_variables</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~final_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge3" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~final_shared_variables~2</title>
<path fill="none" stroke="#000000" d="M146.76,-1361.74C168.05,-1366.28 192.29,-1371.46 214.43,-1376.19"/>
<polygon fill="#000000" stroke="#000000" points="213.46,-1379.56 223.97,-1378.23 214.92,-1372.71 213.46,-1379.56"/>
</g>
<!-- none~init_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node5" class="node">
<title>none~init_shared_variables~2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node5"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-init_shared_variables~2" xlink:title="init_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="782.58,-1185.27 659.31,-1185.27 659.31,-1161 782.58,-1161 782.58,-1185.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-1169.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_shared_variables</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~init_shared_variables~2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge4" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~init_shared_variables~2</title>
<path fill="none" stroke="#000000" d="M91.86,-1361.64C112.53,-1422.28 211.58,-1686.61 397.29,-1782.13 473.58,-1821.38 523.63,-1836.11 590.31,-1782.13 684.07,-1706.23 712.88,-1299.78 718.72,-1196.84"/>
<polygon fill="#000000" stroke="#000000" points="722.2,-1197.28 719.25,-1187.1 715.21,-1196.89 722.2,-1197.28"/>
</g>
<!-- none~set_physics_state_column -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node6" class="node">
<title>none~set_physics_state_column</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node6"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_column" xlink:title="set_physics_state_column">
<polygon fill="#d9534f" stroke="#d9534f" points="359.41,-1361.27 211.39,-1361.27 211.39,-1337 359.41,-1337 359.41,-1361.27"/>
<text xml:space="preserve" text-anchor="middle" x="285.4" y="-1345.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_physics_state_column</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_column -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge5" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_column</title>
<path fill="none" stroke="#000000" d="M174.01,-1349.13C182.52,-1349.13 191.16,-1349.13 199.66,-1349.13"/>
<polygon fill="#000000" stroke="#000000" points="199.62,-1352.64 209.62,-1349.14 199.62,-1345.64 199.62,-1352.64"/>
</g>
<!-- none~set_physics_state_external -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node7" class="node">
<title>none~set_physics_state_external</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node7"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-set_physics_state_external" xlink:title="set_physics_state_external">
<polygon fill="#d9534f" stroke="#d9534f" points="361.29,-659.27 209.52,-659.27 209.52,-635 361.29,-635 361.29,-659.27"/>
<text xml:space="preserve" text-anchor="middle" x="285.4" y="-643.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_physics_state_external</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_external -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge6" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~set_physics_state_external</title>
<path fill="none" stroke="#000000" d="M91.26,-1336.65C114.5,-1253.67 246.71,-781.69 277.84,-670.57"/>
<polygon fill="#000000" stroke="#000000" points="281.17,-671.66 280.5,-661.09 274.43,-669.77 281.17,-671.66"/>
</g>
<!-- none~update_shared_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node8" class="node">
<title>none~update_shared_variables</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node8"><a xlink:href="../proc/dynamics_to_physics_coupling.html#proc-update_shared_variables" xlink:title="update_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="357.54,-129.27 213.27,-129.27 213.27,-105 357.54,-105 357.54,-129.27"/>
<text xml:space="preserve" text-anchor="middle" x="285.4" y="-113.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_shared_variables</text>
</a>
</g>
</g>
<!-- proc~dynamics_to_physics_coupling&#45;&gt;none~update_shared_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge7" class="edge">
<title>proc~dynamics_to_physics_coupling&#45;&gt;none~update_shared_variables</title>
<path fill="none" stroke="#000000" d="M89.77,-1336.54C108.68,-1218.05 255.23,-299.9 280.65,-140.64"/>
<polygon fill="#000000" stroke="#000000" points="284.09,-141.32 282.21,-130.9 277.18,-140.22 284.09,-141.32"/>
</g>
<!-- proc~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node36" class="node">
<title>proc~dyn_debug_print</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node36"><a xlink:href="../proc/dyn_debug_print.html" xlink:title="dyn_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="1472.37,-834.27 1372.35,-834.27 1372.35,-810 1472.37,-810 1472.37,-834.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-818.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_debug_print</text>
</a>
</g>
</g>
<!-- interface~dyn_debug_print&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge8" class="edge">
<title>interface~dyn_debug_print&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1080.38,-1153.85C1120.25,-1157.89 1175.18,-1156.1 1208.85,-1124.13 1277.53,-1058.94 1189.06,-990.65 1244.85,-914.13 1272.95,-875.6 1322.06,-851.87 1361.36,-838.19"/>
<polygon fill="#000000" stroke="#000000" points="1362.34,-841.55 1370.72,-835.07 1360.12,-834.91 1362.34,-841.55"/>
</g>
<!-- proc~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node37" class="node">
<title>proc~dyn_exchange_constituent_states</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node37"><a xlink:href="../proc/dyn_exchange_constituent_states.html" xlink:title="dyn_exchange_constituent_states">
<polygon fill="#d9534f" stroke="#d9534f" points="815.58,-920.27 626.31,-920.27 626.31,-896 815.58,-896 815.58,-920.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-904.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_exchange_constituent_states</text>
</a>
</g>
</g>
<!-- interface~dyn_exchange_constituent_states&#45;&gt;proc~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge9" class="edge">
<title>interface~dyn_exchange_constituent_states&#45;&gt;proc~dyn_exchange_constituent_states</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M588.65,-900.55C597.21,-901.05 605.91,-901.55 614.56,-902.05"/>
<polygon fill="#000000" stroke="#000000" points="614.19,-905.53 624.37,-902.62 614.59,-898.55 614.19,-905.53"/>
</g>
<!-- none~init_shared_variables~2&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge12" class="edge">
<title>none~init_shared_variables~2&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M783.02,-1167.57C836.83,-1162.67 914.78,-1155.56 968.49,-1150.67"/>
<polygon fill="#000000" stroke="#000000" points="968.75,-1154.16 978.39,-1149.77 968.12,-1147.19 968.75,-1154.16"/>
</g>
<!-- check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node14" class="node">
<title>check_allocate</title>
<polygon fill="#777777" stroke="#777777" points="1075.72,-905.27 984.7,-905.27 984.7,-881 1075.72,-881 1075.72,-905.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-889.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_allocate</text>
</g>
<!-- none~init_shared_variables~2&#45;&gt;check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge10" class="edge">
<title>none~init_shared_variables~2&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M723.94,-1160.71C731.51,-1118.03 762.69,-976.55 851.58,-914.13 886.59,-889.55 935.35,-885.34 972.93,-886.7"/>
<polygon fill="#000000" stroke="#000000" points="972.53,-890.19 982.7,-887.21 972.89,-883.2 972.53,-890.19"/>
</g>
<!-- const_is_water_species -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node15" class="node">
<title>const_is_water_species</title>
<polygon fill="#777777" stroke="#777777" points="1097.1,-1073.27 963.33,-1073.27 963.33,-1049 1097.1,-1049 1097.1,-1073.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-1057.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">const_is_water_species</text>
</g>
<!-- none~init_shared_variables~2&#45;&gt;const_is_water_species -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge11" class="edge">
<title>none~init_shared_variables~2&#45;&gt;const_is_water_species</title>
<path fill="none" stroke="#000000" d="M782.75,-1163.81C794.46,-1160.01 806.04,-1154.66 815.58,-1147.13 841.51,-1126.68 824.16,-1100.54 851.58,-1082.13 880.65,-1062.62 918.57,-1056.22 951.91,-1055.17"/>
<polygon fill="#000000" stroke="#000000" points="951.56,-1058.67 961.51,-1055.03 951.46,-1051.67 951.56,-1058.67"/>
</g>
<!-- none~get_variable_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node26" class="node">
<title>none~get_variable_pointer</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node26"><a xlink:href="../type/mpas_dynamical_core_type.html#boundprocedure-get_variable_pointer" xlink:title="mpas_dynamical_core_type%get_variable_pointer">
<polygon fill="#a7506f" stroke="#a7506f" points="1169.1,-1199.27 891.33,-1199.27 891.33,-1175 1169.1,-1175 1169.1,-1199.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-1183.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%get_variable_pointer</text>
</a>
</g>
</g>
<!-- none~init_shared_variables~2&#45;&gt;none~get_variable_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge13" class="edge">
<title>none~init_shared_variables~2&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M783.02,-1175.92C811.05,-1177.19 845.64,-1178.77 879.93,-1180.33"/>
<polygon fill="#000000" stroke="#000000" points="879.39,-1183.81 889.54,-1180.77 879.71,-1176.82 879.39,-1183.81"/>
</g>
<!-- proc~dyn_mpas_map_mpas_scalar_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node39" class="node">
<title>proc~dyn_mpas_map_mpas_scalar_index</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node39"><a xlink:href="../proc/dyn_mpas_map_mpas_scalar_index.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_map_mpas_scalar_index">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1208.85,-1115.27 851.58,-1115.27 851.58,-1091 1208.85,-1091 1208.85,-1115.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-1099.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_map_mpas_scalar_index</text>
</a>
</g>
</g>
<!-- none~init_shared_variables~2&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge14" class="edge">
<title>none~init_shared_variables~2&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index</title>
<path fill="none" stroke="#000000" d="M777.86,-1160.54C790.52,-1156.89 803.72,-1152.43 815.58,-1147.13 832.92,-1139.4 833.7,-1130.52 851.58,-1124.13 857.34,-1122.08 863.26,-1120.21 869.29,-1118.52"/>
<polygon fill="#000000" stroke="#000000" points="869.98,-1121.96 878.78,-1116.05 868.22,-1115.19 869.98,-1121.96"/>
</g>
<!-- lnpint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node22" class="node">
<title>lnpint</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1193.27 466.8,-1193.27 466.8,-1169 520.8,-1169 520.8,-1193.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1177.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpint</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge15" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpint</title>
<path fill="none" stroke="#000000" d="M291.87,-1336.93C305.32,-1308.37 342.94,-1237.01 397.29,-1202.13 414.48,-1191.1 436.62,-1185.8 455.25,-1183.28"/>
<polygon fill="#000000" stroke="#000000" points="455.55,-1186.77 465.1,-1182.19 454.78,-1179.81 455.55,-1186.77"/>
</g>
<!-- lnpintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node23" class="node">
<title>lnpintdry</title>
<polygon fill="#777777" stroke="#777777" points="523.18,-1151.27 464.41,-1151.27 464.41,-1127 523.18,-1127 523.18,-1151.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1135.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpintdry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge16" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpintdry</title>
<path fill="none" stroke="#000000" d="M289.89,-1336.6C300.08,-1302.35 333.27,-1206.65 397.29,-1160.13 413.25,-1148.54 434.41,-1143.14 452.75,-1140.71"/>
<polygon fill="#000000" stroke="#000000" points="452.94,-1144.21 462.51,-1139.68 452.2,-1137.25 452.94,-1144.21"/>
</g>
<!-- lnpmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node24" class="node">
<title>lnpmid</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1109.27 466.8,-1109.27 466.8,-1085 520.8,-1085 520.8,-1109.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1093.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpmid</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge17" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpmid</title>
<path fill="none" stroke="#000000" d="M288.45,-1336.75C295.57,-1297.81 323.01,-1176.96 397.29,-1118.13 413.6,-1105.22 436.19,-1099.85 455.3,-1097.77"/>
<polygon fill="#000000" stroke="#000000" points="455.47,-1101.27 465.15,-1096.99 454.91,-1094.29 455.47,-1101.27"/>
</g>
<!-- lnpmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node25" class="node">
<title>lnpmiddry</title>
<polygon fill="#777777" stroke="#777777" points="526.56,-1773.27 461.04,-1773.27 461.04,-1749 526.56,-1749 526.56,-1773.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1757.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lnpmiddry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;lnpmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge18" class="edge">
<title>none~set_physics_state_column&#45;&gt;lnpmiddry</title>
<path fill="none" stroke="#000000" d="M351.7,-1361.62C355.27,-1364.01 358.52,-1366.82 361.29,-1370.13 414.33,-1433.47 342.47,-1678.34 397.29,-1740.13 410.17,-1754.65 430.58,-1760.39 449.24,-1762.3"/>
<polygon fill="#000000" stroke="#000000" points="448.82,-1765.78 459.03,-1762.94 449.28,-1758.79 448.82,-1765.78"/>
</g>
<!-- omega -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node27" class="node">
<title>omega</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1731.27 466.8,-1731.27 466.8,-1707 520.8,-1707 520.8,-1731.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1715.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omega</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;omega -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge19" class="edge">
<title>none~set_physics_state_column&#45;&gt;omega</title>
<path fill="none" stroke="#000000" d="M351.65,-1361.66C355.23,-1364.04 358.5,-1366.84 361.29,-1370.13 456.14,-1481.98 299.29,-1589.03 397.29,-1698.13 411.61,-1714.08 435.03,-1719.4 455.09,-1720.71"/>
<polygon fill="#000000" stroke="#000000" points="454.81,-1724.2 464.91,-1721.01 455.02,-1717.2 454.81,-1724.2"/>
</g>
<!-- pdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node28" class="node">
<title>pdel</title>
<polygon fill="#777777" stroke="#777777" points="1057.21,-1031.27 1003.21,-1031.27 1003.21,-1007 1057.21,-1007 1057.21,-1031.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-1015.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pdel</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge20" class="edge">
<title>none~set_physics_state_column&#45;&gt;pdel</title>
<path fill="none" stroke="#000000" d="M349.91,-1361.69C354.05,-1364.05 357.91,-1366.84 361.29,-1370.13 400.24,-1408.12 353.53,-1454.81 397.29,-1487.13 466.3,-1538.1 526.49,-1544.46 590.31,-1487.13 646.01,-1437.1 576.53,-1208.07 626.31,-1152.13 683.66,-1087.69 747.26,-1161.8 815.58,-1109.13 842.98,-1088.02 823.11,-1059.77 851.58,-1040.13 892.93,-1011.61 952.95,-1010.75 991.54,-1013.98"/>
<polygon fill="#000000" stroke="#000000" points="990.98,-1017.44 1001.27,-1014.94 991.66,-1010.48 990.98,-1017.44"/>
</g>
<!-- pdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node29" class="node">
<title>pdeldry</title>
<polygon fill="#777777" stroke="#777777" points="1057.21,-989.27 1003.21,-989.27 1003.21,-965 1057.21,-965 1057.21,-989.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-973.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pdeldry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge21" class="edge">
<title>none~set_physics_state_column&#45;&gt;pdeldry</title>
<path fill="none" stroke="#000000" d="M348.8,-1361.72C353.3,-1364.06 357.53,-1366.84 361.29,-1370.13 391.84,-1396.91 363.38,-1431.78 397.29,-1454.13 433.1,-1477.75 558.44,-1482.85 590.31,-1454.13 647.57,-1402.54 574.43,-1166.15 626.31,-1109.13 684.06,-1045.68 747.56,-1123.43 815.58,-1071.13 844.26,-1049.09 822.04,-1019.01 851.58,-998.13 892.72,-969.06 953.05,-968.4 991.73,-971.82"/>
<polygon fill="#000000" stroke="#000000" points="991.18,-975.28 1001.49,-972.83 991.9,-968.32 991.18,-975.28"/>
</g>
<!-- phis -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node30" class="node">
<title>phis</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1689.27 466.8,-1689.27 466.8,-1665 520.8,-1665 520.8,-1689.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1673.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">phis</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;phis -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge22" class="edge">
<title>none~set_physics_state_column&#45;&gt;phis</title>
<path fill="none" stroke="#000000" d="M351.59,-1361.71C355.18,-1364.08 358.47,-1366.86 361.29,-1370.13 444.93,-1467.18 310.92,-1561.51 397.29,-1656.13 411.74,-1671.96 435.16,-1677.29 455.19,-1678.62"/>
<polygon fill="#000000" stroke="#000000" points="454.88,-1682.11 464.99,-1678.94 455.11,-1675.11 454.88,-1682.11"/>
</g>
<!-- pint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node31" class="node">
<title>pint</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1647.27 466.8,-1647.27 466.8,-1623 520.8,-1623 520.8,-1647.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1631.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pint</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pint -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge23" class="edge">
<title>none~set_physics_state_column&#45;&gt;pint</title>
<path fill="none" stroke="#000000" d="M351.17,-1361.57C354.92,-1363.96 358.35,-1366.79 361.29,-1370.13 433.73,-1452.41 322.54,-1533.96 397.29,-1614.13 411.9,-1629.81 435.33,-1635.13 455.32,-1636.5"/>
<polygon fill="#000000" stroke="#000000" points="454.97,-1639.99 465.09,-1636.84 455.22,-1632.99 454.97,-1639.99"/>
</g>
<!-- pintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node32" class="node">
<title>pintdry</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1605.27 466.8,-1605.27 466.8,-1581 520.8,-1581 520.8,-1605.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1589.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pintdry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pintdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge24" class="edge">
<title>none~set_physics_state_column&#45;&gt;pintdry</title>
<path fill="none" stroke="#000000" d="M351.06,-1361.67C354.83,-1364.04 358.3,-1366.84 361.29,-1370.13 422.57,-1437.67 334.11,-1506.37 397.29,-1572.13 411.97,-1587.41 435.04,-1592.79 454.82,-1594.28"/>
<polygon fill="#000000" stroke="#000000" points="454.66,-1597.78 464.8,-1594.7 454.95,-1590.78 454.66,-1597.78"/>
</g>
<!-- pmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node33" class="node">
<title>pmid</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-987.27 466.8,-987.27 466.8,-963 520.8,-963 520.8,-987.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-971.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pmid</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge25" class="edge">
<title>none~set_physics_state_column&#45;&gt;pmid</title>
<path fill="none" stroke="#000000" d="M290.55,-1336.53C302.02,-1301.6 335.07,-1200.53 361.29,-1116.13 377.81,-1062.96 356.47,-1034 397.29,-996.13 412.72,-981.82 435.6,-976.45 455.1,-974.71"/>
<polygon fill="#000000" stroke="#000000" points="455.12,-978.21 464.9,-974.14 454.72,-971.23 455.12,-978.21"/>
</g>
<!-- pmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node34" class="node">
<title>pmiddry</title>
<polygon fill="#777777" stroke="#777777" points="521.68,-1563.27 465.91,-1563.27 465.91,-1539 521.68,-1539 521.68,-1563.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1547.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pmiddry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;pmiddry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge26" class="edge">
<title>none~set_physics_state_column&#45;&gt;pmiddry</title>
<path fill="none" stroke="#000000" d="M350.52,-1361.63C354.47,-1364.01 358.12,-1366.82 361.29,-1370.13 410.16,-1421.26 348.23,-1474.2 397.29,-1525.13 411.97,-1540.38 434.63,-1546.97 454.19,-1549.71"/>
<polygon fill="#000000" stroke="#000000" points="453.74,-1553.18 464.06,-1550.78 454.5,-1546.22 453.74,-1553.18"/>
</g>
<!-- proc~reverse -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node42" class="node">
<title>proc~reverse</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node42"><a xlink:href="../proc/reverse.html" xlink:title="reverse">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1057.21,-947.27 1003.21,-947.27 1003.21,-923 1057.21,-923 1057.21,-947.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-931.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reverse</text>
</a>
</g>
</g>
<!-- none~set_physics_state_column&#45;&gt;proc~reverse -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge27" class="edge">
<title>none~set_physics_state_column&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M287.41,-1336.68C291.62,-1293.14 311.85,-1146.61 397.29,-1076.13 464.74,-1020.5 505.58,-1059.7 590.31,-1038.13 708.25,-1008.11 732.57,-981.61 851.58,-956.13 899.19,-945.94 955.11,-940.36 991.3,-937.56"/>
<polygon fill="#000000" stroke="#000000" points="991.55,-941.05 1001.27,-936.83 991.04,-934.07 991.55,-941.05"/>
</g>
<!-- ps -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node44" class="node">
<title>ps</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1029.27 466.8,-1029.27 466.8,-1005 520.8,-1005 520.8,-1029.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1013.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ps</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;ps -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge28" class="edge">
<title>none~set_physics_state_column&#45;&gt;ps</title>
<path fill="none" stroke="#000000" d="M290.19,-1336.63C306.88,-1281.8 374.07,-1064.53 397.29,-1043.13 412.96,-1028.7 435.85,-1022.15 455.29,-1019.23"/>
<polygon fill="#000000" stroke="#000000" points="455.55,-1022.72 465.06,-1018.05 454.71,-1015.77 455.55,-1022.72"/>
</g>
<!-- psdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node45" class="node">
<title>psdry</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1445.27 466.8,-1445.27 466.8,-1421 520.8,-1421 520.8,-1445.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1429.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">psdry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;psdry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge29" class="edge">
<title>none~set_physics_state_column&#45;&gt;psdry</title>
<path fill="none" stroke="#000000" d="M344.72,-1361.76C350.53,-1364.1 356.17,-1366.87 361.29,-1370.13 382.02,-1383.36 376.19,-1399.51 397.29,-1412.13 414.7,-1422.55 436.67,-1427.82 455.15,-1430.48"/>
<polygon fill="#000000" stroke="#000000" points="454.57,-1433.93 464.91,-1431.66 455.41,-1426.98 454.57,-1433.93"/>
</g>
<!-- rpdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node47" class="node">
<title>rpdel</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1403.27 466.8,-1403.27 466.8,-1379 520.8,-1379 520.8,-1403.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1387.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpdel</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;rpdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge30" class="edge">
<title>none~set_physics_state_column&#45;&gt;rpdel</title>
<path fill="none" stroke="#000000" d="M348.33,-1361.74C383.13,-1368.82 425.43,-1377.43 455.24,-1383.49"/>
<polygon fill="#000000" stroke="#000000" points="454.42,-1386.9 464.92,-1385.46 455.82,-1380.04 454.42,-1386.9"/>
</g>
<!-- rpdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node48" class="node">
<title>rpdeldry</title>
<polygon fill="#777777" stroke="#777777" points="522.06,-1361.27 465.54,-1361.27 465.54,-1337 522.06,-1337 522.06,-1361.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1345.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpdeldry</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;rpdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge31" class="edge">
<title>none~set_physics_state_column&#45;&gt;rpdeldry</title>
<path fill="none" stroke="#000000" d="M359.75,-1349.13C391.4,-1349.13 427.15,-1349.13 453.62,-1349.13"/>
<polygon fill="#000000" stroke="#000000" points="453.56,-1352.64 463.56,-1349.14 453.56,-1345.64 453.56,-1352.64"/>
</g>
<!-- t -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node50" class="node">
<title>t</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1319.27 466.8,-1319.27 466.8,-1295 520.8,-1295 520.8,-1319.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1303.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">t</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;t -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge32" class="edge">
<title>none~set_physics_state_column&#45;&gt;t</title>
<path fill="none" stroke="#000000" d="M348.33,-1336.53C383.13,-1329.45 425.43,-1320.84 455.24,-1314.78"/>
<polygon fill="#000000" stroke="#000000" points="455.82,-1318.23 464.92,-1312.81 454.42,-1311.37 455.82,-1318.23"/>
</g>
<!-- u -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node51" class="node">
<title>u</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1277.27 466.8,-1277.27 466.8,-1253 520.8,-1253 520.8,-1277.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1261.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">u</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;u -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge33" class="edge">
<title>none~set_physics_state_column&#45;&gt;u</title>
<path fill="none" stroke="#000000" d="M304.39,-1336.65C325.66,-1322.43 362.56,-1299.47 397.29,-1286.13 415.88,-1279 437.49,-1273.99 455.45,-1270.66"/>
<polygon fill="#000000" stroke="#000000" points="455.91,-1274.14 465.16,-1268.97 454.71,-1267.24 455.91,-1274.14"/>
</g>
<!-- v -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node54" class="node">
<title>v</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-1235.27 466.8,-1235.27 466.8,-1211 520.8,-1211 520.8,-1235.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-1219.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">v</text>
</g>
<!-- none~set_physics_state_column&#45;&gt;v -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge34" class="edge">
<title>none~set_physics_state_column&#45;&gt;v</title>
<path fill="none" stroke="#000000" d="M295.57,-1336.85C312.84,-1314.62 352.55,-1267.85 397.29,-1244.13 415.1,-1234.7 436.92,-1229.5 455.21,-1226.64"/>
<polygon fill="#000000" stroke="#000000" points="455.43,-1230.14 464.86,-1225.31 454.47,-1223.2 455.43,-1230.14"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge45" class="edge">
<title>none~set_physics_state_external&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M287.5,-659.72C291.99,-703 312.94,-846.93 397.29,-916.13 464.88,-971.59 529.91,-890.92 590.31,-954.13 664.82,-1032.12 544.58,-1123.75 626.31,-1194.13 690.05,-1249.03 736.01,-1221.44 815.58,-1194.13 834.75,-1187.56 832.83,-1173.83 851.58,-1166.13 888.65,-1150.92 933.48,-1145.71 968.83,-1144.28"/>
<polygon fill="#000000" stroke="#000000" points="968.55,-1147.79 978.44,-1143.99 968.34,-1140.8 968.55,-1147.79"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;interface~dyn_exchange_constituent_states -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge46" class="edge">
<title>none~set_physics_state_external&#45;&gt;interface~dyn_exchange_constituent_states</title>
<path fill="none" stroke="#000000" d="M288.58,-659.58C295.99,-698.14 324.03,-816.52 397.29,-874.13 398.45,-875.05 399.65,-875.93 400.87,-876.77"/>
<polygon fill="#000000" stroke="#000000" points="399.03,-879.75 409.43,-881.76 402.56,-873.7 399.03,-879.75"/>
</g>
<!-- cam_constituents_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node9" class="node">
<title>cam_constituents_array</title>
<polygon fill="#777777" stroke="#777777" points="1099.35,-557.27 961.08,-557.27 961.08,-533 1099.35,-533 1099.35,-557.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-541.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_constituents_array</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_constituents_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge35" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_constituents_array</title>
<path fill="none" stroke="#000000" d="M296.42,-634.7C314.14,-613.79 353.35,-572.29 397.29,-556.13 586.79,-486.47 830.35,-511.27 952.35,-530.73"/>
<polygon fill="#000000" stroke="#000000" points="951.49,-534.13 961.92,-532.29 952.62,-527.22 951.49,-534.13"/>
</g>
<!-- cam_model_const_properties -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node10" class="node">
<title>cam_model_const_properties</title>
<polygon fill="#777777" stroke="#777777" points="577.18,-377.27 410.41,-377.27 410.41,-353 577.18,-353 577.18,-377.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-361.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_model_const_properties</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_model_const_properties -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge36" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_model_const_properties</title>
<path fill="none" stroke="#000000" d="M287.97,-634.79C293.87,-593.54 318.58,-459.32 397.29,-391.13 400.94,-387.97 404.95,-385.19 409.18,-382.74"/>
<polygon fill="#000000" stroke="#000000" points="410.68,-385.9 418.06,-378.29 407.55,-379.64 410.68,-385.9"/>
</g>
<!-- cam_thermo_dry_air_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node11" class="node">
<title>cam_thermo_dry_air_update</title>
<polygon fill="#777777" stroke="#777777" points="575.68,-335.27 411.91,-335.27 411.91,-311 575.68,-311 575.68,-335.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-319.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_thermo_dry_air_update</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_thermo_dry_air_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge37" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_thermo_dry_air_update</title>
<path fill="none" stroke="#000000" d="M286.91,-634.72C289.51,-588.46 305.13,-424.67 397.29,-344.13 398.78,-342.83 400.34,-341.6 401.95,-340.44"/>
<polygon fill="#000000" stroke="#000000" points="403.66,-343.5 410.41,-335.33 400.04,-337.51 403.66,-343.5"/>
</g>
<!-- cam_thermo_water_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node12" class="node">
<title>cam_thermo_water_update</title>
<polygon fill="#777777" stroke="#777777" points="572.31,-293.27 415.29,-293.27 415.29,-269 572.31,-269 572.31,-293.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-277.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_thermo_water_update</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cam_thermo_water_update -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge38" class="edge">
<title>none~set_physics_state_external&#45;&gt;cam_thermo_water_update</title>
<path fill="none" stroke="#000000" d="M286.29,-634.8C286.53,-584.83 294.44,-395.69 397.29,-302.13 399.76,-299.89 402.42,-297.86 405.22,-296.03"/>
<polygon fill="#000000" stroke="#000000" points="406.79,-299.16 413.89,-291.29 403.44,-293.02 406.79,-299.16"/>
</g>
<!-- cappav -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node13" class="node">
<title>cappav</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-865.27 466.8,-865.27 466.8,-841 520.8,-841 520.8,-865.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-849.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cappav</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;cappav -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge39" class="edge">
<title>none~set_physics_state_external&#45;&gt;cappav</title>
<path fill="none" stroke="#000000" d="M289.97,-659.41C300.38,-692.95 334.06,-786.65 397.29,-832.13 414.07,-844.2 436.49,-849.54 455.39,-851.82"/>
<polygon fill="#000000" stroke="#000000" points="454.83,-855.29 465.11,-852.74 455.48,-848.32 454.83,-855.29"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge40" class="edge">
<title>none~set_physics_state_external&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M304.34,-659.76C325.56,-674.1 362.42,-697.19 397.29,-710.13 479.26,-740.57 505.74,-725.93 590.31,-748.13 737.46,-786.77 907.37,-847.7 985.63,-876.72"/>
<polygon fill="#000000" stroke="#000000" points="984.04,-879.86 994.63,-880.07 986.48,-873.3 984.04,-879.86"/>
</g>
<!-- const_qmin -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node16" class="node">
<title>const_qmin</title>
<polygon fill="#777777" stroke="#777777" points="529.93,-823.27 457.66,-823.27 457.66,-799 529.93,-799 529.93,-823.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-807.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">const_qmin</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;const_qmin -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge41" class="edge">
<title>none~set_physics_state_external&#45;&gt;const_qmin</title>
<path fill="none" stroke="#000000" d="M292.17,-659.43C306,-687.48 343.92,-756.39 397.29,-790.13 411.86,-799.35 429.91,-804.56 446.37,-807.49"/>
<polygon fill="#000000" stroke="#000000" points="445.55,-810.9 455.96,-808.95 446.6,-803.98 445.55,-810.9"/>
</g>
<!-- endrun -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node17" class="node">
<title>endrun</title>
<polygon fill="#777777" stroke="#777777" points="1057.21,-457.27 1003.21,-457.27 1003.21,-433 1057.21,-433 1057.21,-457.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-441.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endrun</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;endrun -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge42" class="edge">
<title>none~set_physics_state_external&#45;&gt;endrun</title>
<path fill="none" stroke="#000000" d="M288.07,-634.76C294.11,-595.38 318.82,-472.75 397.29,-424.13 497.08,-362.31 871.21,-418.45 991.62,-438.6"/>
<polygon fill="#000000" stroke="#000000" points="990.86,-442.01 1001.3,-440.23 992.02,-435.11 990.86,-442.01"/>
</g>
<!-- exner -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node18" class="node">
<title>exner</title>
<polygon fill="#777777" stroke="#777777" points="520.8,-781.27 466.8,-781.27 466.8,-757 520.8,-757 520.8,-781.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-765.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;exner -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge43" class="edge">
<title>none~set_physics_state_external&#45;&gt;exner</title>
<path fill="none" stroke="#000000" d="M297.37,-659.75C315.9,-680.28 355.49,-720.86 397.29,-743.13 415.29,-752.73 437.13,-759.01 455.38,-763"/>
<polygon fill="#000000" stroke="#000000" points="454.51,-766.39 465.01,-764.94 455.9,-759.53 454.51,-766.39"/>
</g>
<!-- geopotential_temp_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node19" class="node">
<title>geopotential_temp_run</title>
<polygon fill="#777777" stroke="#777777" points="561.43,-701.27 426.16,-701.27 426.16,-677 561.43,-677 561.43,-701.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-685.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">geopotential_temp_run</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;geopotential_temp_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge44" class="edge">
<title>none~set_physics_state_external&#45;&gt;geopotential_temp_run</title>
<path fill="none" stroke="#000000" d="M348.33,-659.74C370.78,-664.3 396.35,-669.51 419.67,-674.25"/>
<polygon fill="#000000" stroke="#000000" points="418.94,-677.68 429.44,-676.24 420.33,-670.82 418.94,-677.68"/>
</g>
<!-- interface~exner_function -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node21" class="node">
<title>interface~exner_function</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node21"><a xlink:href="../interface/exner_function.html" xlink:title="exner_function">
<polygon fill="#a7506f" stroke="#a7506f" points="538.93,-659.27 448.66,-659.27 448.66,-635 538.93,-635 538.93,-659.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-643.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner_function</text>
</a>
</g>
</g>
<!-- none~set_physics_state_external&#45;&gt;interface~exner_function -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge47" class="edge">
<title>none~set_physics_state_external&#45;&gt;interface~exner_function</title>
<path fill="none" stroke="#000000" d="M361.5,-647.13C386.45,-647.13 413.77,-647.13 436.99,-647.13"/>
<polygon fill="#000000" stroke="#000000" points="436.87,-650.64 446.87,-647.14 436.87,-643.64 436.87,-650.64"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;pmid -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge48" class="edge">
<title>none~set_physics_state_external&#45;&gt;pmid</title>
<path fill="none" stroke="#000000" d="M287.08,-659.68C290.24,-705.7 307.57,-866.82 397.29,-949.13 412.99,-963.54 435.88,-970.09 455.32,-973.01"/>
<polygon fill="#000000" stroke="#000000" points="454.73,-976.47 465.08,-974.2 455.57,-969.52 454.73,-976.47"/>
</g>
<!-- proc~dyn_mpas_map_constituent_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node38" class="node">
<title>proc~dyn_mpas_map_constituent_index</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node38"><a xlink:href="../proc/dyn_mpas_map_constituent_index.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_map_constituent_index">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1205.1,-634.27 855.33,-634.27 855.33,-610 1205.1,-610 1205.1,-634.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-618.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_map_constituent_index</text>
</a>
</g>
</g>
<!-- none~set_physics_state_external&#45;&gt;proc~dyn_mpas_map_constituent_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge49" class="edge">
<title>none~set_physics_state_external&#45;&gt;proc~dyn_mpas_map_constituent_index</title>
<path fill="none" stroke="#000000" d="M302.14,-634.65C322.64,-619.25 360.26,-593.92 397.29,-584.13 603.01,-529.77 858.99,-579.37 971.55,-606.77"/>
<polygon fill="#000000" stroke="#000000" points="970.62,-610.15 981.17,-609.15 972.3,-603.35 970.62,-610.15"/>
</g>
<!-- none~set_physics_state_external&#45;&gt;ps -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge50" class="edge">
<title>none~set_physics_state_external&#45;&gt;ps</title>
<path fill="none" stroke="#000000" d="M286.24,-659.61C286.28,-710.14 293.52,-901.42 397.29,-996.13 412.84,-1010.32 435.72,-1015.7 455.2,-1017.46"/>
<polygon fill="#000000" stroke="#000000" points="454.78,-1020.94 464.97,-1018.04 455.2,-1013.96 454.78,-1020.94"/>
</g>
<!-- qneg_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node46" class="node">
<title>qneg_run</title>
<polygon fill="#777777" stroke="#777777" points="524.68,-617.27 462.91,-617.27 462.91,-593 524.68,-593 524.68,-617.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-601.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qneg_run</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;qneg_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge51" class="edge">
<title>none~set_physics_state_external&#45;&gt;qneg_run</title>
<path fill="none" stroke="#000000" d="M348.33,-634.53C381.66,-627.75 421.88,-619.57 451.4,-613.56"/>
<polygon fill="#000000" stroke="#000000" points="451.97,-617.01 461.07,-611.59 450.58,-610.16 451.97,-617.01"/>
</g>
<!-- stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node49" class="node">
<title>stringify</title>
<polygon fill="#777777" stroke="#777777" points="1821.39,-606.27 1767.12,-606.27 1767.12,-582 1821.39,-582 1821.39,-606.27"/>
<text xml:space="preserve" text-anchor="middle" x="1794.25" y="-590.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge52" class="edge">
<title>none~set_physics_state_external&#45;&gt;stringify</title>
<path fill="none" stroke="#000000" d="M287.96,-634.8C295.92,-574.06 334.08,-307.78 397.29,-260.13 511.6,-173.98 1545.29,-511.55 1755.9,-581.62"/>
<polygon fill="#000000" stroke="#000000" points="1754.65,-584.9 1765.24,-584.74 1756.86,-578.25 1754.65,-584.9"/>
</g>
<!-- update_dry_static_energy_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node52" class="node">
<title>update_dry_static_energy_run</title>
<polygon fill="#777777" stroke="#777777" points="579.43,-499.27 408.16,-499.27 408.16,-475 579.43,-475 579.43,-499.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-483.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_dry_static_energy_run</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;update_dry_static_energy_run -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge53" class="edge">
<title>none~set_physics_state_external&#45;&gt;update_dry_static_energy_run</title>
<path fill="none" stroke="#000000" d="M293.16,-634.61C308.19,-607.97 347.04,-545.53 397.29,-513.13 402.84,-509.56 408.88,-506.47 415.13,-503.8"/>
<polygon fill="#000000" stroke="#000000" points="416.32,-507.09 424.4,-500.24 413.81,-500.56 416.32,-507.09"/>
</g>
<!-- update_thermodynamic_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node53" class="node">
<title>update_thermodynamic_variables</title>
<polygon fill="#777777" stroke="#777777" points="590.31,-457.27 397.29,-457.27 397.29,-433 590.31,-433 590.31,-457.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-441.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">update_thermodynamic_variables</text>
</g>
<!-- none~set_physics_state_external&#45;&gt;update_thermodynamic_variables -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge54" class="edge">
<title>none~set_physics_state_external&#45;&gt;update_thermodynamic_variables</title>
<path fill="none" stroke="#000000" d="M290.21,-634.64C301,-601.42 335.15,-510.38 397.29,-466.13 398.91,-464.98 400.57,-463.89 402.29,-462.86"/>
<polygon fill="#000000" stroke="#000000" points="403.89,-465.97 411.16,-458.26 400.67,-459.76 403.89,-465.97"/>
</g>
<!-- interface~clamp -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node20" class="node">
<title>interface~clamp</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node20"><a xlink:href="../interface/clamp.html" xlink:title="clamp">
<polygon fill="#a7506f" stroke="#a7506f" points="520.8,-192.27 466.8,-192.27 466.8,-168 520.8,-168 520.8,-192.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-176.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;interface~clamp -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge55" class="edge">
<title>none~update_shared_variables&#45;&gt;interface~clamp</title>
<path fill="none" stroke="#000000" d="M316.12,-129.74C338.22,-138.79 369.27,-150.8 397.29,-159.13 416.24,-164.78 437.72,-169.63 455.51,-173.25"/>
<polygon fill="#000000" stroke="#000000" points="454.62,-176.64 465.11,-175.15 455.98,-169.77 454.62,-176.64"/>
</g>
<!-- proc~dp_by_hydrostatic_equation -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node35" class="node">
<title>proc~dp_by_hydrostatic_equation</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node35"><a xlink:href="../proc/dp_by_hydrostatic_equation.html" xlink:title="dp_by_hydrostatic_equation">
<polygon fill="#d94e8f" stroke="#d94e8f" points="573.43,-150.27 414.16,-150.27 414.16,-126 573.43,-126 573.43,-150.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-134.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dp_by_hydrostatic_equation</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~dp_by_hydrostatic_equation -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge56" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~dp_by_hydrostatic_equation</title>
<path fill="none" stroke="#000000" d="M358.01,-124.42C372.39,-125.88 387.68,-127.44 402.6,-128.96"/>
<polygon fill="#000000" stroke="#000000" points="402.11,-132.43 412.41,-129.96 402.81,-125.46 402.11,-132.43"/>
</g>
<!-- proc~omega_of_w_rho -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node40" class="node">
<title>proc~omega_of_w_rho</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node40"><a xlink:href="../proc/omega_of_w_rho.html" xlink:title="omega_of_w_rho">
<polygon fill="#d94e8f" stroke="#d94e8f" points="544.56,-108.27 443.04,-108.27 443.04,-84 544.56,-84 544.56,-108.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-92.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omega_of_w_rho</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~omega_of_w_rho -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge57" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~omega_of_w_rho</title>
<path fill="none" stroke="#000000" d="M358.01,-109.85C381.92,-107.42 408.32,-104.73 431.38,-102.38"/>
<polygon fill="#000000" stroke="#000000" points="431.66,-105.87 441.25,-101.38 430.95,-98.91 431.66,-105.87"/>
</g>
<!-- proc~p_by_equation_of_state -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node41" class="node">
<title>proc~p_by_equation_of_state</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node41"><a xlink:href="../proc/p_by_equation_of_state.html" xlink:title="p_by_equation_of_state">
<polygon fill="#d94e8f" stroke="#d94e8f" points="561.81,-66.27 425.79,-66.27 425.79,-42 561.81,-42 561.81,-66.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-50.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_by_equation_of_state</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~p_by_equation_of_state -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge58" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~p_by_equation_of_state</title>
<path fill="none" stroke="#000000" d="M316.12,-104.53C338.22,-95.48 369.27,-83.47 397.29,-75.14 404.02,-73.13 411.06,-71.23 418.15,-69.45"/>
<polygon fill="#000000" stroke="#000000" points="418.91,-72.86 427.81,-67.1 417.26,-66.06 418.91,-72.86"/>
</g>
<!-- proc~t_of_tm_qv -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node43" class="node">
<title>proc~t_of_tm_qv</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node43"><a xlink:href="../proc/t_of_tm_qv.html" xlink:title="t_of_tm_qv">
<polygon fill="#d94e8f" stroke="#d94e8f" points="528.06,-24.27 459.54,-24.27 459.54,0 528.06,0 528.06,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="493.8" y="-8.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">t_of_tm_qv</text>
</a>
</g>
</g>
<!-- none~update_shared_variables&#45;&gt;proc~t_of_tm_qv -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge59" class="edge">
<title>none~update_shared_variables&#45;&gt;proc~t_of_tm_qv</title>
<path fill="none" stroke="#000000" d="M298.84,-104.75C318.17,-86.24 357.38,-51.55 397.29,-33.14 413.2,-25.79 431.8,-20.96 448.34,-17.8"/>
<polygon fill="#000000" stroke="#000000" points="448.66,-21.3 457.91,-16.14 447.46,-14.4 448.66,-21.3"/>
</g>
<!-- proc~clamp_int32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node56" class="node">
<title>proc~clamp_int32</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node56"><a xlink:href="../proc/clamp_int32.html" xlink:title="clamp_int32">
<polygon fill="#d94e8f" stroke="#d94e8f" points="759.33,-234.27 682.56,-234.27 682.56,-210 759.33,-210 759.33,-234.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-218.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_int32</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_int32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge60" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_int32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.07,-185.04C557.75,-191.88 624.97,-204.42 671.03,-213.01"/>
<polygon fill="#000000" stroke="#000000" points="670.29,-216.43 680.76,-214.83 671.57,-209.55 670.29,-216.43"/>
</g>
<!-- proc~clamp_int64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node57" class="node">
<title>proc~clamp_int64</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node57"><a xlink:href="../proc/clamp_int64.html" xlink:title="clamp_int64">
<polygon fill="#d94e8f" stroke="#d94e8f" points="759.33,-192.27 682.56,-192.27 682.56,-168 759.33,-168 759.33,-192.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-176.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_int64</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_int64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge61" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_int64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.07,-180.13C557.75,-180.13 624.97,-180.13 671.03,-180.13"/>
<polygon fill="#000000" stroke="#000000" points="670.74,-183.64 680.74,-180.14 670.74,-176.64 670.74,-183.64"/>
</g>
<!-- proc~clamp_real32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node58" class="node">
<title>proc~clamp_real32</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node58"><a xlink:href="../proc/clamp_real32.html" xlink:title="clamp_real32">
<polygon fill="#d94e8f" stroke="#d94e8f" points="762.7,-150.27 679.18,-150.27 679.18,-126 762.7,-126 762.7,-150.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-134.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_real32</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_real32 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge62" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_real32</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.07,-175.23C556.89,-168.55 621.86,-156.43 667.77,-147.87"/>
<polygon fill="#000000" stroke="#000000" points="668.33,-151.32 677.52,-146.05 667.05,-144.44 668.33,-151.32"/>
</g>
<!-- proc~clamp_real64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node59" class="node">
<title>proc~clamp_real64</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node59"><a xlink:href="../proc/clamp_real64.html" xlink:title="clamp_real64">
<polygon fill="#d94e8f" stroke="#d94e8f" points="762.7,-108.27 679.18,-108.27 679.18,-84 762.7,-84 762.7,-108.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-92.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">clamp_real64</text>
</a>
</g>
</g>
<!-- interface~clamp&#45;&gt;proc~clamp_real64 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge63" class="edge">
<title>interface~clamp&#45;&gt;proc~clamp_real64</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.18,-178.84C541.35,-176.84 569.19,-171.78 590.31,-159.13 611.41,-146.51 605.24,-129.8 626.31,-117.14 638.81,-109.62 653.72,-104.78 667.93,-101.68"/>
<polygon fill="#000000" stroke="#000000" points="668.46,-105.14 677.62,-99.83 667.14,-98.27 668.46,-105.14"/>
</g>
<!-- proc~exner_function_of_cpd_p0_rd_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node74" class="node">
<title>proc~exner_function_of_cpd_p0_rd_p</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node74"><a xlink:href="../proc/exner_function_of_cpd_p0_rd_p.html" xlink:title="exner_function_of_cpd_p0_rd_p">
<polygon fill="#d94e8f" stroke="#d94e8f" points="809.95,-680.27 631.93,-680.27 631.93,-656 809.95,-656 809.95,-680.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-664.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner_function_of_cpd_p0_rd_p</text>
</a>
</g>
</g>
<!-- interface~exner_function&#45;&gt;proc~exner_function_of_cpd_p0_rd_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge64" class="edge">
<title>interface~exner_function&#45;&gt;proc~exner_function_of_cpd_p0_rd_p</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.28,-651.28C562.59,-653.46 592.13,-656.21 620.54,-658.86"/>
<polygon fill="#000000" stroke="#000000" points="619.99,-662.33 630.27,-659.77 620.64,-655.36 619.99,-662.33"/>
</g>
<!-- proc~exner_function_of_kappa_p0_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node75" class="node">
<title>proc~exner_function_of_kappa_p0_p</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node75"><a xlink:href="../proc/exner_function_of_kappa_p0_p.html" xlink:title="exner_function_of_kappa_p0_p">
<polygon fill="#d94e8f" stroke="#d94e8f" points="808.45,-638.27 633.43,-638.27 633.43,-614 808.45,-614 808.45,-638.27"/>
<text xml:space="preserve" text-anchor="middle" x="720.94" y="-622.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exner_function_of_kappa_p0_p</text>
</a>
</g>
</g>
<!-- interface~exner_function&#45;&gt;proc~exner_function_of_kappa_p0_p -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge65" class="edge">
<title>interface~exner_function&#45;&gt;proc~exner_function_of_kappa_p0_p</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M539.28,-642.99C562.93,-640.78 592.99,-637.98 621.78,-635.29"/>
<polygon fill="#000000" stroke="#000000" points="622.02,-638.78 631.65,-634.37 621.37,-631.81 622.02,-638.78"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node61" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node61"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.87,-1031.27 1244.85,-1031.27 1244.85,-1007 1599.87,-1007 1599.87,-1031.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1015.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge66" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1169.53,-1187.35C1183.88,-1182.71 1197.38,-1175.9 1208.85,-1166.13 1253.2,-1128.39 1200.51,-1077.9 1244.85,-1040.13 1245.65,-1039.46 1246.45,-1038.79 1247.27,-1038.14"/>
<polygon fill="#000000" stroke="#000000" points="1248.99,-1041.22 1255.12,-1032.58 1244.94,-1035.5 1248.99,-1041.22"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node62" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c1</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node62"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.87,-1199.27 1244.85,-1199.27 1244.85,-1175 1599.87,-1175 1599.87,-1199.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1183.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge67" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1169.59,-1187.13C1190.11,-1187.13 1211.55,-1187.13 1232.89,-1187.13"/>
<polygon fill="#000000" stroke="#000000" points="1232.86,-1190.64 1242.86,-1187.14 1232.86,-1183.64 1232.86,-1190.64"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node63" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node63"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="1598.37,-989.27 1246.35,-989.27 1246.35,-965 1598.37,-965 1598.37,-989.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-973.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge68" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1169.31,-1188.39C1183.87,-1183.62 1197.48,-1176.49 1208.85,-1166.13 1265.31,-1114.72 1188.41,-1049.57 1244.85,-998.13 1245.49,-997.55 1246.14,-996.98 1246.8,-996.41"/>
<polygon fill="#000000" stroke="#000000" points="1248.65,-999.4 1254.49,-990.55 1244.41,-993.83 1248.65,-999.4"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node64" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i1</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node64"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="1598.37,-1115.27 1246.35,-1115.27 1246.35,-1091 1598.37,-1091 1598.37,-1115.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1099.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge69" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1169.18,-1181.25C1183.04,-1177.62 1196.52,-1172.71 1208.85,-1166.13 1230.54,-1154.57 1223.16,-1135.71 1244.85,-1124.13 1247.56,-1122.69 1250.33,-1121.32 1253.15,-1120.03"/>
<polygon fill="#000000" stroke="#000000" points="1254.28,-1123.35 1262.15,-1116.27 1251.58,-1116.89 1254.28,-1123.35"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node65" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node65"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="1598.37,-1157.27 1246.35,-1157.27 1246.35,-1133 1598.37,-1133 1598.37,-1157.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1141.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge70" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148.54,-1174.51C1194.04,-1169.61 1246.3,-1163.98 1292.82,-1158.97"/>
<polygon fill="#000000" stroke="#000000" points="1293.13,-1162.46 1302.7,-1157.91 1292.38,-1155.5 1293.13,-1162.46"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node66" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i3</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node66"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="1598.37,-1451.27 1246.35,-1451.27 1246.35,-1427 1598.37,-1427 1598.37,-1451.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1435.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge71" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1038.33,-1199.74C1061.76,-1239.88 1140.95,-1365.17 1244.85,-1418.13 1247.81,-1419.65 1250.84,-1421.07 1253.92,-1422.4"/>
<polygon fill="#000000" stroke="#000000" points="1252.59,-1425.64 1263.18,-1426.07 1255.17,-1419.13 1252.59,-1425.64"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node67" class="node">
<title>proc~dyn_mpas_get_variable_pointer_l0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node67"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_l0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0">
<polygon fill="#d9534f" stroke="#d9534f" points="1598.37,-947.27 1246.35,-947.27 1246.35,-923 1598.37,-923 1598.37,-947.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-931.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge72" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1169.29,-1188.99C1183.95,-1184.14 1197.59,-1176.82 1208.85,-1166.13 1277.53,-1100.94 1176.19,-1021.35 1244.85,-956.13 1245.36,-955.65 1245.87,-955.18 1246.39,-954.71"/>
<polygon fill="#000000" stroke="#000000" points="1248.33,-957.63 1253.96,-948.66 1243.97,-952.16 1248.33,-957.63"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node68" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r0</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node68"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.12,-1073.27 1245.6,-1073.27 1245.6,-1049 1599.12,-1049 1599.12,-1073.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1057.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge73" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1169.26,-1185.61C1183.49,-1181.24 1197.03,-1174.97 1208.85,-1166.13 1241.39,-1141.82 1212.32,-1106.46 1244.85,-1082.13 1246.03,-1081.25 1247.23,-1080.39 1248.45,-1079.56"/>
<polygon fill="#000000" stroke="#000000" points="1250.09,-1082.66 1256.78,-1074.45 1246.42,-1076.69 1250.09,-1082.66"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node69" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r1</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node69"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.12,-1409.27 1245.6,-1409.27 1245.6,-1385 1599.12,-1385 1599.12,-1409.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1393.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge74" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1040.62,-1199.63C1067.78,-1234.62 1150.4,-1333.8 1244.85,-1376.13 1248.66,-1377.84 1252.57,-1379.43 1256.55,-1380.91"/>
<polygon fill="#000000" stroke="#000000" points="1255.19,-1384.14 1265.79,-1384.06 1257.45,-1377.52 1255.19,-1384.14"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node70" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r2</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node70"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.12,-1367.27 1245.6,-1367.27 1245.6,-1343 1599.12,-1343 1599.12,-1367.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1351.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge75" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1044.36,-1199.72C1075.94,-1229.07 1159.75,-1302.05 1244.85,-1334.13 1250.13,-1336.13 1255.55,-1337.94 1261.08,-1339.59"/>
<polygon fill="#000000" stroke="#000000" points="1259.78,-1342.86 1270.35,-1342.16 1261.65,-1336.12 1259.78,-1342.86"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node71" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r3</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node71"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.12,-1325.27 1245.6,-1325.27 1245.6,-1301 1599.12,-1301 1599.12,-1325.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1309.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge76" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1050.9,-1199.67C1087.49,-1222.32 1169.16,-1269.74 1244.85,-1292.13 1252.39,-1294.37 1260.18,-1296.36 1268.1,-1298.15"/>
<polygon fill="#000000" stroke="#000000" points="1267.37,-1301.57 1277.87,-1300.22 1268.82,-1294.72 1267.37,-1301.57"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node72" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r4</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node72"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r4.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.12,-1283.27 1245.6,-1283.27 1245.6,-1259 1599.12,-1259 1599.12,-1283.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1267.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge77" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1067.03,-1199.72C1109.1,-1214.02 1181.22,-1237.06 1244.85,-1250.13 1257.01,-1252.63 1269.7,-1254.86 1282.46,-1256.85"/>
<polygon fill="#000000" stroke="#000000" points="1281.78,-1260.29 1292.19,-1258.31 1282.82,-1253.36 1281.78,-1260.29"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node73" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r5</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node73"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r5.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5">
<polygon fill="#d9534f" stroke="#d9534f" points="1599.12,-1241.27 1245.6,-1241.27 1245.6,-1217 1599.12,-1217 1599.12,-1241.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-1225.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge78" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1148.54,-1199.76C1194.04,-1204.66 1246.3,-1210.29 1292.82,-1215.3"/>
<polygon fill="#000000" stroke="#000000" points="1292.38,-1218.77 1302.7,-1216.36 1293.13,-1211.81 1292.38,-1218.77"/>
</g>
<!-- proc~dyn_debug_print&#45;&gt;stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge79" class="edge">
<title>proc~dyn_debug_print&#45;&gt;stringify</title>
<path fill="none" stroke="#000000" d="M1472.65,-816.76C1509.5,-811.14 1560.15,-799.96 1599.87,-778.13 1677.38,-735.55 1746.79,-654.21 1777.11,-615.56"/>
<polygon fill="#000000" stroke="#000000" points="1779.68,-617.95 1783.03,-607.9 1774.14,-613.67 1779.68,-617.95"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;interface~dyn_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge85" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;interface~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M725.22,-920.62C735.91,-958.7 773.72,-1073.79 851.58,-1124.13 885.97,-1146.37 932.06,-1151.27 968.67,-1150.79"/>
<polygon fill="#000000" stroke="#000000" points="968.29,-1154.31 978.19,-1150.53 968.1,-1147.31 968.29,-1154.31"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;cam_constituents_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge80" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;cam_constituents_array</title>
<path fill="none" stroke="#000000" d="M727.29,-895.82C741.71,-862.55 782.55,-768.1 815.58,-689.13 831.89,-650.15 820.49,-629.75 851.58,-601.13 878.3,-576.54 915.76,-562.75 949.4,-555.02"/>
<polygon fill="#000000" stroke="#000000" points="950.11,-558.44 959.16,-552.93 948.65,-551.6 950.11,-558.44"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;check_allocate -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge81" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M815.81,-903.55C867.16,-901.05 929.08,-898.02 972.96,-895.88"/>
<polygon fill="#000000" stroke="#000000" points="972.94,-899.39 982.76,-895.4 972.6,-892.39 972.94,-899.39"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;const_is_water_species -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge83" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;const_is_water_species</title>
<path fill="none" stroke="#000000" d="M729.83,-920.67C747.69,-947.84 794.19,-1011.98 851.58,-1040.13 882.26,-1055.18 919.38,-1061.18 951.74,-1063.12"/>
<polygon fill="#000000" stroke="#000000" points="951.3,-1066.6 961.45,-1063.57 951.63,-1059.61 951.3,-1066.6"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;endrun -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge84" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;endrun</title>
<path fill="none" stroke="#000000" d="M728.3,-895.62C744.82,-862.64 789.64,-770.27 815.58,-689.13 838.44,-617.64 804.18,-582.33 851.58,-524.13 886.97,-480.69 951.15,-460.37 991.91,-451.45"/>
<polygon fill="#000000" stroke="#000000" points="992.42,-454.92 1001.51,-449.49 991.01,-448.07 992.42,-454.92"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;none~get_variable_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge86" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M723.96,-920.51C731.58,-963.04 762.92,-1103.98 851.58,-1166.13 860.45,-1172.35 870.2,-1177.27 880.43,-1181.12"/>
<polygon fill="#000000" stroke="#000000" points="879.21,-1184.4 889.81,-1184.27 881.44,-1177.76 879.21,-1184.4"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;pdel -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge87" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;pdel</title>
<path fill="none" stroke="#000000" d="M735.03,-920.59C757.09,-940.75 803.93,-980.07 851.58,-998.13 897.7,-1015.61 954.96,-1019.49 991.79,-1019.91"/>
<polygon fill="#000000" stroke="#000000" points="991.47,-1023.41 1001.47,-1019.94 991.48,-1016.41 991.47,-1023.41"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;pdeldry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge88" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;pdeldry</title>
<path fill="none" stroke="#000000" d="M749.92,-920.7C775.78,-931.77 815.53,-947.46 851.58,-956.13 899.26,-967.61 955.7,-972.92 991.96,-975.3"/>
<polygon fill="#000000" stroke="#000000" points="991.28,-978.77 1001.48,-975.88 991.71,-971.78 991.28,-978.77"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_constituent_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge90" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_constituent_index</title>
<path fill="none" stroke="#000000" d="M726.53,-895.66C744.01,-848.83 807.65,-684.48 851.58,-652.13 858.41,-647.11 865.79,-642.81 873.52,-639.14"/>
<polygon fill="#000000" stroke="#000000" points="874.68,-642.45 882.47,-635.27 871.91,-636.02 874.68,-642.45"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge91" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_map_mpas_scalar_index</title>
<path fill="none" stroke="#000000" d="M726.95,-920.53C740.98,-953.43 784.07,-1043.11 851.58,-1082.13 853.82,-1083.43 856.1,-1084.66 858.42,-1085.83"/>
<polygon fill="#000000" stroke="#000000" points="856.88,-1088.98 867.43,-1089.97 859.81,-1082.62 856.88,-1088.98"/>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~reverse -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge92" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M815.81,-916.38C874.85,-921.57 947.85,-927.99 991.36,-931.81"/>
<polygon fill="#000000" stroke="#000000" points="991.03,-935.29 1001.3,-932.68 991.65,-928.32 991.03,-935.29"/>
</g>
<!-- const_is_dry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node55" class="node">
<title>const_is_dry</title>
<polygon fill="#777777" stroke="#777777" points="1068.22,-685.27 992.2,-685.27 992.2,-661 1068.22,-661 1068.22,-685.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-669.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">const_is_dry</text>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;const_is_dry -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge82" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;const_is_dry</title>
<path fill="none" stroke="#000000" d="M725.25,-895.76C736.06,-858.03 774.15,-743.98 851.58,-694.13 889.8,-669.54 942.38,-666.2 980.41,-667.85"/>
<polygon fill="#000000" stroke="#000000" points="980.01,-671.34 990.2,-668.42 980.42,-664.35 980.01,-671.34"/>
</g>
<!-- proc~dyn_mpas_exchange_halo -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node60" class="node">
<title>proc~dyn_mpas_exchange_halo</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node60"><a xlink:href="../proc/dyn_mpas_exchange_halo.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_exchange_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="1184.1,-727.27 876.33,-727.27 876.33,-703 1184.1,-703 1184.1,-727.27"/>
<text xml:space="preserve" text-anchor="middle" x="1030.21" y="-711.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_exchange_halo</text>
</a>
</g>
</g>
<!-- proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge89" class="edge">
<title>proc~dyn_exchange_constituent_states&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M741.63,-895.77C794.08,-862.83 937.4,-772.8 999.68,-733.69"/>
<polygon fill="#000000" stroke="#000000" points="1001.4,-736.74 1008.01,-728.45 997.68,-730.81 1001.4,-736.74"/>
</g>
<!-- mpas_dmpar_exch_halo_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node76" class="node">
<title>mpas_dmpar_exch_halo_field</title>
<polygon fill="#777777" stroke="#777777" points="1506.49,-769.27 1338.22,-769.27 1338.22,-745 1506.49,-745 1506.49,-769.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-753.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dmpar_exch_halo_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge93" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field</title>
<path fill="none" stroke="#000000" d="M1148.54,-727.76C1205.52,-733.9 1273.09,-741.17 1326.73,-746.95"/>
<polygon fill="#000000" stroke="#000000" points="1326.13,-750.4 1336.45,-747.99 1326.88,-743.44 1326.13,-750.4"/>
</g>
<!-- mpas_pool_get_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node80" class="node">
<title>mpas_pool_get_field</title>
<polygon fill="#777777" stroke="#777777" points="1482.49,-727.27 1362.22,-727.27 1362.22,-703 1482.49,-703 1482.49,-727.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-711.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge94" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field</title>
<path fill="none" stroke="#000000" d="M1184.57,-715.13C1241.81,-715.13 1304.07,-715.13 1350.38,-715.13"/>
<polygon fill="#000000" stroke="#000000" points="1350.28,-718.64 1360.28,-715.14 1350.28,-711.64 1350.28,-718.64"/>
</g>
<!-- mpas_pool_get_field_info -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node81" class="node">
<title>mpas_pool_get_field_info</title>
<polygon fill="#777777" stroke="#777777" points="1495.24,-685.27 1349.47,-685.27 1349.47,-661 1495.24,-661 1495.24,-685.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-669.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field_info</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge95" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info</title>
<path fill="none" stroke="#000000" d="M1148.54,-702.51C1209.63,-695.93 1282.89,-688.04 1338.1,-682.1"/>
<polygon fill="#000000" stroke="#000000" points="1338.18,-685.61 1347.74,-681.06 1337.43,-678.65 1338.18,-685.61"/>
</g>
<!-- proc~dyn_mpas_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node82" class="node">
<title>proc~dyn_mpas_debug_print</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node82"><a xlink:href="../proc/dyn_mpas_debug_print.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="1567.99,-234.27 1276.72,-234.27 1276.72,-210 1567.99,-210 1567.99,-234.27"/>
<text xml:space="preserve" text-anchor="middle" x="1422.36" y="-218.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_debug_print</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge96" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print</title>
<path fill="none" stroke="#000000" d="M1184.28,-710.34C1193.17,-706.12 1201.48,-700.8 1208.85,-694.13 1263.57,-644.68 1218.31,-600.95 1244.85,-532.13 1289.28,-416.96 1371.53,-293.21 1405.77,-244.06"/>
<polygon fill="#000000" stroke="#000000" points="1408.56,-246.16 1411.45,-235.97 1402.84,-242.14 1408.56,-246.16"/>
</g>
<!-- proc~stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node84" class="node">
<title>proc~stringify</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node84"><a xlink:href="../proc/stringify.html" xlink:title="stringify">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1821.39,-384.27 1767.12,-384.27 1767.12,-360 1821.39,-360 1821.39,-384.27"/>
<text xml:space="preserve" text-anchor="middle" x="1794.25" y="-368.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge97" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1184.23,-704.72C1192.77,-701.8 1201.04,-698.3 1208.85,-694.13 1230.54,-682.57 1225.54,-667.35 1244.85,-652.13 1416.37,-517.05 1663.25,-419.29 1756.09,-385.28"/>
<polygon fill="#000000" stroke="#000000" points="1757.26,-388.58 1765.46,-381.88 1754.87,-382 1757.26,-388.58"/>
</g>
<!-- mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node77" class="node">
<title>mpas_pool_get_array</title>
<polygon fill="#777777" stroke="#777777" points="1857.01,-1241.27 1731.49,-1241.27 1731.49,-1217 1857.01,-1217 1857.01,-1241.27"/>
<text xml:space="preserve" text-anchor="middle" x="1794.25" y="-1225.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_array</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge98" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1589.03,-1031.64C1592.82,-1034.19 1596.45,-1037.02 1599.87,-1040.13 1656.31,-1091.57 1579.8,-1156.3 1635.87,-1208.13 1658.22,-1228.79 1690.56,-1235.54 1720.12,-1236.53"/>
<polygon fill="#000000" stroke="#000000" points="1719.73,-1240.03 1729.77,-1236.63 1719.81,-1233.03 1719.73,-1240.03"/>
</g>
<!-- mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node78" class="node">
<title>mpas_pool_get_config</title>
<polygon fill="#777777" stroke="#777777" points="1859.26,-1010.27 1729.24,-1010.27 1729.24,-986 1859.26,-986 1859.26,-1010.27"/>
<text xml:space="preserve" text-anchor="middle" x="1794.25" y="-994.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_config</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge99" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1600.18,-1009.1C1641.57,-1006.75 1683.5,-1004.37 1717.66,-1002.43"/>
<polygon fill="#000000" stroke="#000000" points="1717.64,-1005.93 1727.43,-1001.87 1717.24,-998.94 1717.64,-1005.93"/>
</g>
<!-- proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node83" class="node">
<title>proc~dyn_mpas_get_pool_pointer</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CallsGraph_node83"><a xlink:href="../proc/dyn_mpas_get_pool_pointer.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_pool_pointer">
<polygon fill="#d9534f" stroke="#d9534f" points="1952.64,-1199.27 1635.87,-1199.27 1635.87,-1175 1952.64,-1175 1952.64,-1199.27"/>
<text xml:space="preserve" text-anchor="middle" x="1794.25" y="-1183.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_pool_pointer</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge100" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1583.36,-1031.6C1589.07,-1034.09 1594.6,-1036.93 1599.87,-1040.13 1624.2,-1054.93 1615.16,-1073.59 1635.87,-1093.13 1671.22,-1126.48 1720.4,-1153.49 1754.33,-1169.86"/>
<polygon fill="#000000" stroke="#000000" points="1752.43,-1172.84 1762.97,-1173.95 1755.42,-1166.51 1752.43,-1172.84"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge101" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1534.59,-1199.76C1594.55,-1206.57 1666.87,-1214.78 1719.78,-1220.79"/>
<polygon fill="#000000" stroke="#000000" points="1719.27,-1224.26 1729.6,-1221.91 1720.06,-1217.3 1719.27,-1224.26"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge102" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1600.18,-1187.13C1608.2,-1187.13 1616.24,-1187.13 1624.23,-1187.13"/>
<polygon fill="#000000" stroke="#000000" points="1623.99,-1190.64 1633.99,-1187.14 1623.99,-1183.64 1623.99,-1190.64"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge103" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1589.57,-989.71C1593.18,-992.25 1596.63,-995.05 1599.87,-998.13 1668.53,-1063.35 1567.68,-1142.43 1635.87,-1208.13 1657.87,-1229.34 1690.33,-1236.11 1720.06,-1236.99"/>
<polygon fill="#000000" stroke="#000000" points="1719.76,-1240.48 1729.78,-1237.04 1719.8,-1233.48 1719.76,-1240.48"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge104" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1598.83,-987.1C1640.57,-989.47 1682.95,-991.87 1717.44,-993.83"/>
<polygon fill="#000000" stroke="#000000" points="1717.14,-997.32 1727.32,-994.39 1717.53,-990.33 1717.14,-997.32"/>
</g>
<!-- mpas_pool_get_dimension -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node79" class="node">
<title>mpas_pool_get_dimension</title>
<polygon fill="#777777" stroke="#777777" points="1870.51,-1084.27 1717.99,-1084.27 1717.99,-1060 1870.51,-1060 1870.51,-1084.27"/>
<text xml:space="preserve" text-anchor="middle" x="1794.25" y="-1068.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_dimension</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge105" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1569.38,-989.71C1579.81,-992.07 1590.07,-994.85 1599.87,-998.13 1617.43,-1004.02 1619.01,-1011.47 1635.87,-1019.13 1668.48,-1033.95 1706.51,-1046.87 1737.01,-1056.24"/>
<polygon fill="#000000" stroke="#000000" points="1735.86,-1059.55 1746.44,-1059.09 1737.88,-1052.85 1735.86,-1059.55"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge106" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1587.23,-989.65C1591.63,-992.18 1595.86,-995 1599.87,-998.13 1635.44,-1025.94 1606.88,-1058.52 1635.87,-1093.13 1665.97,-1129.06 1713.52,-1154.76 1748.48,-1170.11"/>
<polygon fill="#000000" stroke="#000000" points="1746.93,-1173.26 1757.51,-1173.95 1749.67,-1166.81 1746.93,-1173.26"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge107" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1586.65,-1115.65C1591.25,-1118.18 1595.67,-1120.99 1599.87,-1124.13 1632.4,-1148.46 1603.52,-1183.58 1635.87,-1208.13 1659.52,-1226.09 1691.13,-1232.65 1719.81,-1234.23"/>
<polygon fill="#000000" stroke="#000000" points="1719.43,-1237.72 1729.54,-1234.56 1719.66,-1230.72 1719.43,-1237.72"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge108" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1574.08,-1090.5C1619.01,-1086.74 1666.74,-1082.74 1706.15,-1079.43"/>
<polygon fill="#000000" stroke="#000000" points="1706.39,-1082.93 1716.06,-1078.6 1705.8,-1075.95 1706.39,-1082.93"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge109" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1553.98,-1115.74C1569.52,-1118.11 1585.1,-1120.88 1599.87,-1124.13 1652.98,-1135.83 1712.19,-1156.25 1750.93,-1170.67"/>
<polygon fill="#000000" stroke="#000000" points="1749.28,-1173.79 1759.87,-1174.04 1751.74,-1167.24 1749.28,-1173.79"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge110" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1581.17,-1157.68C1587.62,-1160.14 1593.88,-1162.94 1599.87,-1166.13 1621.56,-1177.71 1614.26,-1196.4 1635.87,-1208.13 1661.21,-1221.89 1692.11,-1227.91 1719.8,-1230.22"/>
<polygon fill="#000000" stroke="#000000" points="1719.32,-1233.7 1729.54,-1230.88 1719.79,-1226.71 1719.32,-1233.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge111" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1534.59,-1157.76C1577.55,-1162.64 1626.86,-1168.24 1670.82,-1173.23"/>
<polygon fill="#000000" stroke="#000000" points="1670.34,-1176.7 1680.67,-1174.35 1671.13,-1169.75 1670.34,-1176.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge112" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1579.04,-1426.53C1586.21,-1424.11 1593.19,-1421.33 1599.87,-1418.13 1681.47,-1379.1 1749.78,-1291.77 1778.59,-1250.94"/>
<polygon fill="#000000" stroke="#000000" points="1781.36,-1253.08 1784.18,-1242.87 1775.61,-1249.1 1781.36,-1253.08"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge113" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1589.57,-1426.56C1593.18,-1424.02 1596.63,-1421.22 1599.87,-1418.13 1668.53,-1352.92 1567.68,-1273.84 1635.87,-1208.13 1636.38,-1207.64 1636.9,-1207.16 1637.42,-1206.68"/>
<polygon fill="#000000" stroke="#000000" points="1639.5,-1209.5 1645.16,-1200.54 1635.15,-1204.01 1639.5,-1209.5"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge114" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1542.74,-947.77C1561.89,-950.25 1581.46,-953.05 1599.87,-956.13 1643.97,-963.53 1693.21,-974.26 1730.97,-983.03"/>
<polygon fill="#000000" stroke="#000000" points="1729.8,-986.34 1740.33,-985.21 1731.39,-979.53 1729.8,-986.34"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge115" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1588.45,-947.6C1592.44,-950.16 1596.26,-952.99 1599.87,-956.13 1647.36,-997.46 1598.04,-1042.81 1635.87,-1093.13 1663.6,-1130.02 1710.41,-1155.28 1745.79,-1170.25"/>
<polygon fill="#000000" stroke="#000000" points="1744.38,-1173.45 1754.97,-1173.99 1747.03,-1166.97 1744.38,-1173.45"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge116" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1588.37,-1073.7C1592.38,-1076.23 1596.23,-1079.03 1599.87,-1082.13 1644.21,-1119.9 1591.8,-1170.06 1635.87,-1208.13 1658.61,-1227.78 1690.53,-1234.51 1719.68,-1235.75"/>
<polygon fill="#000000" stroke="#000000" points="1719.54,-1239.24 1729.6,-1235.94 1719.67,-1232.25 1719.54,-1239.24"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge117" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1542.74,-1048.5C1561.89,-1046.02 1581.46,-1043.22 1599.87,-1040.13 1643.97,-1032.74 1693.21,-1022.01 1730.97,-1013.24"/>
<polygon fill="#000000" stroke="#000000" points="1731.39,-1016.74 1740.33,-1011.06 1729.8,-1009.93 1731.39,-1016.74"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge118" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1567.86,-1073.75C1578.8,-1076.09 1589.58,-1078.86 1599.87,-1082.13 1663.43,-1102.35 1730.24,-1143.83 1766.3,-1168.16"/>
<polygon fill="#000000" stroke="#000000" points="1764.15,-1170.93 1774.38,-1173.69 1768.1,-1165.15 1764.15,-1170.93"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge119" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1574.93,-1384.54C1583.49,-1382.16 1591.86,-1379.37 1599.87,-1376.13 1672.37,-1346.83 1741.3,-1282.85 1773.8,-1249.81"/>
<polygon fill="#000000" stroke="#000000" points="1776.12,-1252.44 1780.56,-1242.82 1771.09,-1247.57 1776.12,-1252.44"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge120" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1589.03,-1384.63C1592.82,-1382.08 1596.45,-1379.25 1599.87,-1376.13 1656.31,-1324.7 1579.8,-1259.97 1635.87,-1208.13 1636.52,-1207.54 1637.17,-1206.95 1637.83,-1206.38"/>
<polygon fill="#000000" stroke="#000000" points="1639.79,-1209.29 1645.65,-1200.46 1635.56,-1203.71 1639.79,-1209.29"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge121" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1567.86,-1342.52C1578.8,-1340.18 1589.58,-1337.41 1599.87,-1334.13 1663.43,-1313.92 1730.24,-1272.44 1766.3,-1248.11"/>
<polygon fill="#000000" stroke="#000000" points="1768.1,-1251.12 1774.38,-1242.58 1764.15,-1245.34 1768.1,-1251.12"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge122" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1588.37,-1342.57C1592.38,-1340.04 1596.23,-1337.24 1599.87,-1334.13 1644.21,-1296.37 1591.8,-1246.21 1635.87,-1208.13 1636.67,-1207.45 1637.48,-1206.77 1638.3,-1206.11"/>
<polygon fill="#000000" stroke="#000000" points="1640.09,-1209.14 1646.24,-1200.51 1636.05,-1203.41 1640.09,-1209.14"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge123" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1553.98,-1300.53C1569.52,-1298.16 1585.1,-1295.39 1599.87,-1292.13 1652.98,-1280.44 1712.19,-1260.02 1750.93,-1245.6"/>
<polygon fill="#000000" stroke="#000000" points="1751.74,-1249.03 1759.87,-1242.23 1749.28,-1242.48 1751.74,-1249.03"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge124" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1586.65,-1300.62C1591.25,-1298.09 1595.67,-1295.28 1599.87,-1292.13 1632.4,-1267.81 1603.52,-1232.69 1635.87,-1208.13 1637.04,-1207.24 1638.24,-1206.38 1639.45,-1205.55"/>
<polygon fill="#000000" stroke="#000000" points="1641.07,-1208.66 1647.78,-1200.45 1637.42,-1202.68 1641.07,-1208.66"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge125" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1534.59,-1258.51C1594.55,-1251.7 1666.87,-1243.49 1719.78,-1237.48"/>
<polygon fill="#000000" stroke="#000000" points="1720.06,-1240.97 1729.6,-1236.36 1719.27,-1234.01 1720.06,-1240.97"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge126" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1581.17,-1258.59C1587.62,-1256.13 1593.88,-1253.33 1599.87,-1250.13 1621.56,-1238.56 1614.26,-1219.87 1635.87,-1208.13 1638.56,-1206.67 1641.31,-1205.3 1644.12,-1204.01"/>
<polygon fill="#000000" stroke="#000000" points="1645.2,-1207.35 1653.08,-1200.27 1642.51,-1200.89 1645.2,-1207.35"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge127" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1599.37,-1229.13C1641.87,-1229.13 1685,-1229.13 1719.76,-1229.13"/>
<polygon fill="#000000" stroke="#000000" points="1719.7,-1232.64 1729.7,-1229.14 1719.7,-1225.64 1719.7,-1232.64"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge128" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1534.59,-1216.51C1577.55,-1211.63 1626.86,-1206.03 1670.82,-1201.04"/>
<polygon fill="#000000" stroke="#000000" points="1671.13,-1204.52 1680.67,-1199.92 1670.34,-1197.57 1671.13,-1204.52"/>
</g>
<!-- proc~dyn_mpas_debug_print&#45;&gt;proc~stringify -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge129" class="edge">
<title>proc~dyn_mpas_debug_print&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1552.71,-234.7C1568.86,-238.15 1584.93,-242.54 1599.87,-248.13 1667.13,-273.31 1735.45,-324.42 1770.06,-352.53"/>
<polygon fill="#000000" stroke="#000000" points="1767.79,-355.19 1777.73,-358.84 1772.23,-349.78 1767.79,-355.19"/>
</g>
<!-- mpas_pool_get_subpool -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_node85" class="node">
<title>mpas_pool_get_subpool</title>
<polygon fill="#777777" stroke="#777777" points="2127.66,-1199.27 1988.64,-1199.27 1988.64,-1175 2127.66,-1175 2127.66,-1199.27"/>
<text xml:space="preserve" text-anchor="middle" x="2058.15" y="-1183.54" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_subpool</text>
</g>
<!-- proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool -->
<g id="proc~~dynamics_to_physics_coupling~~CallsGraph_edge130" class="edge">
<title>proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool</title>
<path fill="none" stroke="#000000" d="M1952.89,-1187.13C1961.02,-1187.13 1969,-1187.13 1976.71,-1187.13"/>
<polygon fill="#000000" stroke="#000000" points="1976.67,-1190.64 1986.67,-1187.14 1976.67,-1183.64 1976.67,-1190.64"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocdynamics_to_physics_couplingCallsGraph = svgPanZoom('#procdynamics_to_physics_couplingCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.0 (20251207.0913)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 28.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.873868 0.873868) rotate(0) translate(4 28.27)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28.27 729.52,-28.27 729.52,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="69.27,-24.27 0,-24.27 0,0 69.27,0 69.27,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="34.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="143.89,-24.27 87.38,-24.27 87.38,0 143.89,0 143.89,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="115.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="221.39,-24.27 161.88,-24.27 161.88,0 221.39,0 221.39,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="191.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="368.27,-24.27 239,-24.27 239,0 368.27,0 368.27,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="303.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="529.39,-24.27 385.88,-24.27 385.88,0 529.39,0 529.39,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="457.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="603.89,-24.27 547.38,-24.27 547.38,0 603.89,0 603.89,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="575.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="725.52,-24.27 621.75,-24.27 621.75,0 725.52,0 725.52,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="673.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Called by</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.0 (20251207.0913)
 -->
<!-- Title: proc~~dynamics_to_physics_coupling~~CalledByGraph Pages: 1 -->
<svg id="procdynamics_to_physics_couplingCalledByGraph" width="548pt" height="32pt"
 viewBox="0.00 0.00 548.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28.27)">
<title>proc~~dynamics_to_physics_coupling~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28.27 544.06,-28.27 544.06,4 -4,4"/>
<!-- proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_node1" class="node">
<title>proc~dynamics_to_physics_coupling</title>
<polygon fill="none" stroke="black" points="540.06,-24.27 366.54,-24.27 366.54,0 540.06,0 540.06,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="453.3" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50">dynamics_to_physics_coupling</text>
</g>
<!-- interface~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_node2" class="node">
<title>interface~dynamics_to_physics_coupling</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CalledByGraph_node2"><a xlink:href="../interface/dynamics_to_physics_coupling.html" xlink:title="dynamics_to_physics_coupling">
<polygon fill="#a7506f" stroke="#a7506f" points="330.54,-24.27 157.02,-24.27 157.02,0 330.54,0 330.54,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="243.78" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dynamics_to_physics_coupling</text>
</a>
</g>
</g>
<!-- interface~dynamics_to_physics_coupling&#45;&gt;proc~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_edge1" class="edge">
<title>interface~dynamics_to_physics_coupling&#45;&gt;proc~dynamics_to_physics_coupling</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M330.98,-12.13C338.93,-12.13 347.02,-12.13 355.06,-12.13"/>
<polygon fill="#000000" stroke="#000000" points="354.85,-15.64 364.85,-12.14 354.85,-8.64 354.85,-15.64"/>
</g>
<!-- proc~stepon_timestep_init -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_node3" class="node">
<title>proc~stepon_timestep_init</title>
<g id="a_proc~~dynamics_to_physics_coupling~~CalledByGraph_node3"><a xlink:href="../proc/stepon_timestep_init.html" xlink:title="stepon_timestep_init">
<polygon fill="#d9534f" stroke="#d9534f" points="121.02,-24.27 0,-24.27 0,0 121.02,0 121.02,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="60.51" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stepon_timestep_init</text>
</a>
</g>
</g>
<!-- proc~stepon_timestep_init&#45;&gt;interface~dynamics_to_physics_coupling -->
<g id="proc~~dynamics_to_physics_coupling~~CalledByGraph_edge2" class="edge">
<title>proc~stepon_timestep_init&#45;&gt;interface~dynamics_to_physics_coupling</title>
<path fill="none" stroke="#000000" d="M121.37,-12.13C129.08,-12.13 137.12,-12.13 145.25,-12.13"/>
<polygon fill="#000000" stroke="#000000" points="145.24,-15.64 155.24,-12.14 145.24,-8.64 145.24,-15.64"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.0 (20251207.0913)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 28.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.873868 0.873868) rotate(0) translate(4 28.27)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28.27 729.52,-28.27 729.52,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="69.27,-24.27 0,-24.27 0,0 69.27,0 69.27,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="34.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="143.89,-24.27 87.38,-24.27 87.38,0 143.89,0 143.89,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="115.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="221.39,-24.27 161.88,-24.27 161.88,0 221.39,0 221.39,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="191.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="368.27,-24.27 239,-24.27 239,0 368.27,0 368.27,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="303.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="529.39,-24.27 385.88,-24.27 385.88,0 529.39,0 529.39,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="457.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="603.89,-24.27 547.38,-24.27 547.38,0 603.89,0 603.89,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="575.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="725.52,-24.27 621.75,-24.27 621.75,0 725.52,0 725.52,-24.27"/>
<text xml:space="preserve" text-anchor="middle" x="673.63" y="-8.53" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
      <br>


        <section>
          <h2>Variables</h2>
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-column_index"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>column_index</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dp_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dp_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dpd_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dpd_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dz_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>dz_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-exner"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>exner</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-index_qv~4"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>index_qv</strong></td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-is_water_species_index~2"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>is_water_species_index</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-omega_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>omega_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p_int_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>p_int_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>p_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pd_int_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>pd_int_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-pd_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>pd_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-qv_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>qv_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rho_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rho_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rho_zz"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>rho_zz</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rhod_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>rhod_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scalars~4"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>scalars</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-sigma_all_q_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>sigma_all_q_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-subname~68"></span>
              character(len=*),
            </td>
              <td>private,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>subname</strong></td>
<td> =</td>
                <td>&#39;dyn_coupling::dynamics_to_physics_coupling&#39;</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>t_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-theta_m"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>theta_m</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tm_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>tm_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tv_mid_col~2"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>tv_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-u_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>u_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ucellmeridional~3"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>ucellmeridional</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ucellzonal~3"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>ucellzonal</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-v_mid_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>v_mid_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-w~4"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>w</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z_int_col"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>z_int_col</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zgrid~3"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>zgrid</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zz~2"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>zz</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

        </section>
        <br>






        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-final_shared_variables~2"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-final_shared_variables~2'>final_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Finalize variables that are shared and repeatedly used by the <code>update_shared_variables</code> and
<code>set_physics_state_column</code> internal subroutines.
(KCW, 2024-07-20)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-init_shared_variables~2"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-init_shared_variables~2'>init_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Initialize variables that are shared and repeatedly used by the <code>update_shared_variables</code> and
<code>set_physics_state_column</code> internal subroutines.
(KCW, 2024-07-20)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_physics_state_column"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-set_physics_state_column'>set_physics_state_column</a>(i)  
</h3></div>
    <div class="card-body">
          
  <p>Set variables for the specific column, indicated by <code>i</code>, in the <code>physics_state</code> derived type.
This subroutine and <code>update_shared_variables</code> should be called in pairs.
(KCW, 2024-07-30)</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-i~25"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_physics_state_external"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-set_physics_state_external'>set_physics_state_external</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set variables in the <code>physics_state</code> derived type by calling external procedures.
(KCW, 2024-07-30)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-update_shared_variables"></span> <h3> subroutine <a href='dynamics_to_physics_coupling.html#proc-update_shared_variables'>update_shared_variables</a>(i)  
</h3></div>
    <div class="card-body">
          
  <p>Update variables for the specific column, indicated by <code>i</code>. This subroutine and <code>set_physics_state_column</code>
should be called in pairs.
(KCW, 2024-07-30)</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-i~24"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>i</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

        </section>


        <section>
          <h2><span class="anchor" id="src"></span>Source Code</h2>
          <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">module subroutine </span><span class="n">dynamics_to_physics_coupling</span><span class="p">()</span>
<span class="w">        </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">        </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">debugout_info</span>
<span class="w">        </span><span class="k">use </span><span class="n">dyn_comp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_debug_print</span><span class="p">,</span><span class="w"> </span><span class="n">kind_dyn_mpas</span>
<span class="w">        </span><span class="k">use </span><span class="n">dyn_grid</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">        </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">        </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">kind_r8</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_r8</span>

<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling&#39;</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">column_index</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">is_water_species_index</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">index_qv</span>
<span class="w">        </span><span class="c">! Variable name suffixes have the following meanings:</span>
<span class="w">        </span><span class="c">! `*_col`: Variable is of each column.</span>
<span class="w">        </span><span class="c">! `*_int`: Variable is at layer interfaces.</span>
<span class="w">        </span><span class="c">! `*_mid`: Variable is at layer midpoints.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pd_int_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Dry hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">pd_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Dry non-hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">p_int_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Full hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">p_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Full non-hydrostatic air pressure (Pa).</span>
<span class="w">                                      </span><span class="n">z_int_col</span><span class="p">(:)</span><span class="w">           </span><span class="c">! Geometric height (m).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">          </span><span class="c">! Dry air pressure difference (Pa) between layer interfaces.</span>
<span class="w">                                      </span><span class="n">dp_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">           </span><span class="c">! Full air pressure difference (Pa) between layer interfaces.</span>
<span class="w">                                      </span><span class="n">dz_col</span><span class="p">(:)</span><span class="w">              </span><span class="c">! Geometric height difference (m) between layer interfaces.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Water vapor mixing ratio (kg kg-1).</span>
<span class="w">                                      </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="c">! Summation of all water species mixing ratios (kg kg-1).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">     </span><span class="c">! Dry air density (kg m-3).</span>
<span class="w">                                      </span><span class="n">rho_mid_col</span><span class="p">(:)</span><span class="w">         </span><span class="c">! Full air density (kg m-3).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Temperature (K).</span>
<span class="w">                                      </span><span class="n">tm_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">       </span><span class="c">! Modified &quot;moist&quot; temperature (K).</span>
<span class="w">                                      </span><span class="n">tv_mid_col</span><span class="p">(:)</span><span class="w">          </span><span class="c">! Virtual temperature (K).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">u_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Eastward wind velocity (m s-1).</span>
<span class="w">                                      </span><span class="n">v_mid_col</span><span class="p">(:),</span><span class="w"> </span><span class="p">&amp;</span><span class="w">        </span><span class="c">! Northward wind velocity (m s-1).</span>
<span class="w">                                      </span><span class="n">omega_mid_col</span><span class="p">(:)</span><span class="w">       </span><span class="c">! Vertical pressure velocity (Pa s-1).</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">exner</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rho_zz</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scalars</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">theta_m</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">w</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; entered&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="k">call </span><span class="n">init_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_exchange_constituent_states</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">exchange</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="n">conversion</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_info</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting physics state variables column by column&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="c">! Set variables in the `physics_state` derived type column by column.</span>
<span class="w">        </span><span class="c">! This way, peak memory usage can be reduced.</span>
<span class="w">        </span><span class="k">do </span><span class="n">column_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">            </span><span class="k">call </span><span class="n">update_shared_variables</span><span class="p">(</span><span class="n">column_index</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">set_physics_state_column</span><span class="p">(</span><span class="n">column_index</span><span class="p">)</span>
<span class="w">        </span><span class="k">end do</span>

<span class="k">        call </span><span class="n">set_physics_state_external</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">final_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; completed&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">contains</span>
<span class="w">        </span><span class="c">!&gt; Initialize variables that are shared and repeatedly used by the `update_shared_variables` and</span>
<span class="w">        </span><span class="c">!&gt; `set_physics_state_column` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-20)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">init_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">const_is_water_species</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_comp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">mpas_dynamical_core</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::init_shared_variables&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">is_water_species</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_info</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Preparing for dynamics-physics coupling&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">exner</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_m</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">is_water_species</span><span class="p">(</span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;is_water_species(num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">                </span><span class="n">is_water_species</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">const_is_water_species</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            allocate</span><span class="p">(</span><span class="n">is_water_species_index</span><span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="n">is_water_species</span><span class="p">)),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;is_water_species_index(count(is_water_species))&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="n">is_water_species_index</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="nb">pack</span><span class="p">([(</span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_mpas_scalar_index</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span><span class="p">)],</span><span class="w"> </span><span class="n">is_water_species</span><span class="p">)</span>

<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">is_water_species</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="n">pd_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;pd_int_col(pverp), pd_mid_col(pver), p_int_col(pverp), p_mid_col(pver), z_int_col(pverp)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">dpd_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">dz_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;dpd_col(pver), dp_col(pver), dz_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;qv_mid_col(pver), sigma_all_q_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">rhod_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;rhod_mid_col(pver), rho_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">t_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">tv_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;t_mid_col(pver), tm_mid_col(pver), tv_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">u_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">v_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">omega_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;u_mid_col(pver), v_mid_col(pver), omega_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dim&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;index_qv&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">exner</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;exner&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rho_zz&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scalars&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">theta_m</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;theta_m&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructZonal&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructMeridional&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zgrid</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zgrid&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zz&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">init_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Finalize variables that are shared and repeatedly used by the `update_shared_variables` and</span>
<span class="w">        </span><span class="c">!&gt; `set_physics_state_column` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-20)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">final_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::final_shared_variables&#39;</span>

<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">is_water_species_index</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">pd_int_col</span><span class="p">,</span><span class="w"> </span><span class="n">pd_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">,</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">dpd_col</span><span class="p">,</span><span class="w"> </span><span class="n">dp_col</span><span class="p">,</span><span class="w"> </span><span class="n">dz_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">rhod_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">t_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">tv_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">u_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">v_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">omega_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">exner</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_m</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">final_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Update variables for the specific column, indicated by `i`. This subroutine and `set_physics_state_column`</span>
<span class="w">        </span><span class="c">!&gt; should be called in pairs.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-30)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">update_shared_variables</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp_by_hydrostatic_equation</span><span class="p">,</span><span class="w"> </span><span class="n">omega_of_w_rho</span><span class="p">,</span><span class="w"> </span><span class="n">p_by_equation_of_state</span><span class="p">,</span><span class="w"> </span><span class="n">t_of_tm_qv</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rv</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rh2o</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span>
<span class="w">            </span><span class="c">! Module(s) from MPAS.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_mpas_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">clamp</span>

<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::update_shared_variables&#39;</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span>
<span class="w">            </span><span class="c">! Proximity limit, in fraction, on how close `p{,d}_mid_col` is allowed to be around its surrounding `p{,d}_int_col`.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05_kind_r8</span>

<span class="w">            </span><span class="c">! The summation term of equation 5 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">scalars</span><span class="p">(</span><span class="n">is_water_species_index</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Compute thermodynamic variables.</span>

<span class="w">            </span><span class="c">! By definition.</span>
<span class="w">            </span><span class="n">z_int_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">dz_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">)</span>
<span class="w">            </span><span class="n">qv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">rhod_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">rho_zz</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Equation 5 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">rho_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span>

<span class="w">            </span><span class="c">! Hydrostatic equation.</span>
<span class="w">            </span><span class="n">dpd_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp_by_hydrostatic_equation</span><span class="p">(</span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">dz_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">dp_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp_by_hydrostatic_equation</span><span class="p">(</span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">dz_col</span><span class="p">)</span>

<span class="w">            </span><span class="c">! By definition of Exner function. Also see below.</span>
<span class="w">            </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">theta_m</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">exner</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>

<span class="w">            </span><span class="c">! The paragraph below equation 2.7 in doi:10.5065/1DFH-6P97.</span>
<span class="w">            </span><span class="c">! The paragraph below equation 2 in doi:10.1175/MWR-D-11-00215.1.</span>
<span class="w">            </span><span class="n">t_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_of_tm_qv</span><span class="p">(</span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rv</span><span class="p">,</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Equation 16 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="c">! The numerator terms are just `tm_mid_col` here (i.e., modified &quot;moist&quot; temperature).</span>
<span class="w">            </span><span class="n">tv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sigma_all_q_mid_col</span><span class="p">(:)</span>

<span class="w">            </span><span class="c">! Equation of state.</span>
<span class="w">            </span><span class="c">! Equation 11 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">pd_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_equation_of_state</span><span class="p">(</span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">t_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Equation 17 in doi:10.1029/2017MS001257.</span>
<span class="w">            </span><span class="n">p_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_equation_of_state</span><span class="p">(</span><span class="n">constant_rd</span><span class="p">,</span><span class="w"> </span><span class="n">rho_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">tv_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="c">! By definition.</span>
<span class="w">            </span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pd_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span>
<span class="w">            </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(</span><span class="n">pver</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Integrate downward.</span>
<span class="w">            </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                </span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pd_int_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">                </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="w">            </span><span class="c">! `p{,d}_mid_col` is not guaranteed to be bounded by `p{,d}_int_col` because the former is non-hydrostatic</span>
<span class="w">            </span><span class="c">! while the latter is hydrostatic. In high-resolution simulations, the former could exceed the latter,</span>
<span class="w">            </span><span class="c">! leading to a model crash in physics.</span>
<span class="w">            </span><span class="c">! Impose range limits on `p{,d}_mid_col` so it is bounded by `p{,d}_int_col`.</span>
<span class="w">            </span><span class="n">pd_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clamp</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pd_mid_col</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pd_int_col</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pd_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dpd_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">)</span>
<span class="w">            </span><span class="n">p_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clamp</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">p_mid_col</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">p_int_col</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">p_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dp_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">p_int_mid_proximity_limit</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Compute momentum variables.</span>

<span class="w">            </span><span class="c">! By definition.</span>
<span class="w">            </span><span class="n">u_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">v_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">            </span><span class="n">omega_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">omega_of_w_rho</span><span class="p">(</span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">pverp</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="n">rhod_mid_col</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">update_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Set variables for the specific column, indicated by `i`, in the `physics_state` derived type.</span>
<span class="w">        </span><span class="c">!&gt; This subroutine and `update_shared_variables` should be called in pairs.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-30)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_physics_state_column</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">reverse</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span>
<span class="w">            </span><span class="k">use </span><span class="n">physics_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">phys_state</span>

<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::set_physics_state_column&#39;</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="c">! Always call `reverse` when assigning anything to/from the `physics_state` derived type.</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">u_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">v_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">omega</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">omega_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">psdry</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pd_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pintdry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">pd_int_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmiddry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">pd_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdeldry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">-</span><span class="n">dpd_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpintdry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pintdry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpmiddry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmiddry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">rpdeldry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdeldry</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">ps</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">p_int_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="o">-</span><span class="n">dp_col</span><span class="p">)</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">rpdel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">t_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">phis</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">z_int_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_physics_state_column</span>

<span class="w">        </span><span class="c">!&gt; Set variables in the `physics_state` derived type by calling external procedures.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-30)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_physics_state_external</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span><span class="p">,</span><span class="w"> </span><span class="n">endrun</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">const_qmin</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_thermo</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_thermo_dry_air_update</span><span class="p">,</span><span class="w"> </span><span class="n">cam_thermo_water_update</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_thermo_formula</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">energy_formula_dycore_mpas</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_comp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">mpas_dynamical_core</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_procedures</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">exner_function</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span>
<span class="w">            </span><span class="k">use </span><span class="n">physics_types</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cappav</span><span class="p">,</span><span class="w"> </span><span class="n">cp_or_cv_dycore</span><span class="p">,</span><span class="w"> </span><span class="n">cpairv</span><span class="p">,</span><span class="w"> </span><span class="n">lagrangian_vertical</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="p">,</span><span class="w"> </span><span class="n">rairv</span><span class="p">,</span><span class="w"> </span><span class="n">zvirv</span>
<span class="w">            </span><span class="k">use </span><span class="n">runtime_obj</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_runtime_opts</span>
<span class="w">            </span><span class="k">use </span><span class="n">string_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">stringify</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span>
<span class="w">            </span><span class="c">! Module(s) from CCPP.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_ccpp_cap</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_constituents_array</span><span class="p">,</span><span class="w"> </span><span class="n">cam_model_const_properties</span>
<span class="w">            </span><span class="k">use </span><span class="n">ccpp_constituent_prop_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">ccpp_constituent_prop_ptr_t</span>
<span class="w">            </span><span class="k">use </span><span class="n">ccpp_kinds</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">kind_phys</span>
<span class="w">            </span><span class="k">use </span><span class="n">geopotential_temp</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">geopotential_temp_run</span>
<span class="w">            </span><span class="k">use </span><span class="n">qneg</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">qneg_run</span>
<span class="w">            </span><span class="k">use </span><span class="n">static_energy</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">update_dry_static_energy_run</span>
<span class="w">            </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">            </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">len_cx</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_cx</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_coupling::dynamics_to_physics_coupling::set_physics_state_external&#39;</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="n">len_cx</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cerr</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_phys</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">minimum_constituents</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_phys</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituents</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="k">type</span><span class="p">(</span><span class="n">ccpp_constituent_prop_ptr_t</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituent_properties</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_info</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting physics state variables externally&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituents</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituent_properties</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">minimum_constituents</span><span class="p">(</span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="n">cerr</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;minimum_constituents(num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;dyn_coupling&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="o">=</span><span class="err">__</span><span class="n">LINE__</span><span class="p">,</span><span class="w"> </span><span class="n">errmsg</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)))</span>

<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">                </span><span class="n">minimum_constituents</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">const_qmin</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            </span><span class="n">constituents</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_constituents_array</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">constituents</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;constituents&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            </span><span class="n">constituent_properties</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_model_const_properties</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">constituent_properties</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;constituent_properties&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! Update `cappav`, `cpairv`, `rairv`, `zvirv`, etc. as needed by calling `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="c">! Note that this subroutine expects constituents to be dry.</span>
<span class="w">            </span><span class="k">call </span><span class="n">cam_thermo_dry_air_update</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">cam_runtime_opts</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">update_thermodynamic_variables</span><span class="p">())</span>

<span class="w">            </span><span class="c">! Update `cp_or_cv_dycore` by calling `cam_thermo_water_update`.</span>
<span class="w">            </span><span class="c">! Note that this subroutine expects constituents to be dry.</span>
<span class="w">            </span><span class="k">call </span><span class="n">cam_thermo_water_update</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">energy_formula_dycore_mpas</span><span class="p">,</span><span class="w"> </span><span class="n">cp_or_cv_dycore</span><span class="p">)</span>

<span class="w">            </span><span class="c">! This variable name is really misleading. It actually represents the reciprocal of Exner function</span>
<span class="w">            </span><span class="c">! with respect to surface pressure. This definition is sometimes used for boundary layer work. See</span>
<span class="w">            </span><span class="c">! the paragraph below equation 1.5.1c in doi:10.1007/978-94-009-3027-8.</span>
<span class="w">            </span><span class="c">! Also note that `cappav` is updated externally by `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exner</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">exner_function</span><span class="p">(</span><span class="n">cappav</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">ps</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="k">end do</span>

<span class="w">            </span><span class="c">! Note that constituents become moist after this.</span>
<span class="w">            </span><span class="k">call </span><span class="n">dyn_exchange_constituent_states</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">exchange</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">conversion</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>

<span class="w">            </span><span class="c">! Impose minimum limits on constituents.</span>
<span class="w">            </span><span class="k">call </span><span class="n">qneg_run</span><span class="p">(</span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">minimum_constituents</span><span class="p">,</span><span class="w"> </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">cerr</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to impose minimum limits on constituents externally&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;External procedure returned with &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">stringify</span><span class="p">([</span><span class="n">ierr</span><span class="p">])</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! Set `zi` (i.e., geopotential height at layer interfaces) and `zm` (i.e., geopotential height at layer midpoints).</span>
<span class="w">            </span><span class="c">! Note that `rairv` and `zvirv` are updated externally by `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="k">call </span><span class="n">geopotential_temp_run</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">lagrangian_vertical</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">lnpint</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pint</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pmid</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">pdel</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">rpdel</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituents</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_constituent_index</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)),</span><span class="w"> </span><span class="n">constituents</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituent_properties</span><span class="p">,</span><span class="w"> </span><span class="n">rairv</span><span class="p">,</span><span class="w"> </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">zvirv</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">zi</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">zm</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">cerr</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to set variable &quot;zi&quot; and &quot;zm&quot; externally&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;External procedure returned with &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">stringify</span><span class="p">([</span><span class="n">ierr</span><span class="p">])</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="w">            </span><span class="c">! Set `dse` (i.e., dry static energy).</span>
<span class="w">            </span><span class="c">! Note that `cpairv` is updated externally by `cam_thermo_dry_air_update`.</span>
<span class="w">            </span><span class="k">call </span><span class="n">update_dry_static_energy_run</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">constant_g</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">zm</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">phis</span><span class="p">,</span><span class="w"> </span><span class="n">phys_state</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">dse</span><span class="p">,</span><span class="w"> </span><span class="n">cpairv</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">cerr</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to set variable &quot;dse&quot; externally&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="s1">&#39;External procedure returned with &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">stringify</span><span class="p">([</span><span class="n">ierr</span><span class="p">])</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">cerr</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">minimum_constituents</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituents</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">constituent_properties</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_physics_state_external</span>
<span class="w">    </span><span class="k">end subroutine </span><span class="n">dynamics_to_physics_coupling</span>
</pre></div>

        </section>
        <br>
    </div>
  </div>
      <hr>
    </div>

    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              MPAS Dynamical Core
was developed by CAM-SIMA & MPAS Developers<br>              © 2025 
            </p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div>
    </footer>
  </body>
</html>